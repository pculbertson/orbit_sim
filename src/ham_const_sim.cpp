#include <eigen3/Eigen/Dense>
#include <eigen3/Eigen/Eigen>
#include <math.h>
#include "ros/ros.h"
#include "geometry_msgs/Vector3.h"
#include "orbit_sim/refSig6.h"
#include <stdlib.h>
#include <sstream>
#include "std_msgs/Header.h"
#include "gazebo_msgs/LinkStates.h"
#include "geometry_msgs/Wrench.h"
#include "geometry_msgs/Pose.h"
#include "geometry_msgs/PoseStamped.h"
#include "geometry_msgs/Twist.h"
#include "nav_msgs/Path.h"
#include "orbit_sim/state.h"
#include "Ybody.h"
#include "qDes_const.h"

using namespace Eigen;
typedef Matrix<double, 6, 6> Matrix6d;
typedef Matrix<double, 6, 1> Vector6d;

class Controller{
	int robotNum;
	double time;
	double startTime;
	double db;
	VectorXd a;
	Vector6d q, qd;
	Matrix6d Kd, L;
	Matrix<double,40,40> Gamma;
	ros::Publisher cmd_pub;
	ros::Publisher state_pub;
	ros::Publisher path_pub;
	int seq;
	nav_msgs::Path path;
	geometry_msgs::PoseStamped pose;
	std_msgs::Header h;
	public:
		Controller(int, ros::NodeHandle);
		void stateCallback(const gazebo_msgs::LinkStates::ConstPtr& _msg);

};

Controller::Controller(int input, ros::NodeHandle n){
	srand(input);
	this->robotNum = input;
	this->time = 0;
	this->q = Vector6d::Zero();
	this->qd = Vector6d::Zero();
	this->a = 1e-12*VectorXd::Random(40);
	//this->Gamma = 0*Matrix<double,40,40>::Identity();
	double gW;
	n.getParam("/gW",gW);
	double kdW_l;
	n.getParam("/kdW_l",kdW_l);
	double kdW_a;
	n.getParam("/kdW_a",kdW_a);
	double lW;
	n.getParam("/lW",lW);
	n.getParam("/db",db);
	this->Gamma = gW*Matrix<double,40,40>::Identity();
	Vector6d KdVec;
	KdVec << kdW_l*MatrixXd::Ones(3,1), kdW_a*MatrixXd::Ones(3,1);
	this->Kd = KdVec.asDiagonal();
	this->L = lW*Matrix6d::Identity();
	this->cmd_pub = n.advertise<geometry_msgs::Wrench>("wrenchPlugin/wrenchCommands",1000); //remapped in launch file to correct topic
	this->state_pub = n.advertise<orbit_sim::state>("controllerState",1000);
	path_pub = n.advertise<nav_msgs::Path>("orbit_path",1000);
	h = std_msgs::Header();
	h.frame_id = "1";
	pose = geometry_msgs::PoseStamped();
	path = nav_msgs::Path();
	startTime = 0;
};

void Controller::stateCallback(const gazebo_msgs::LinkStates::ConstPtr& _msg){
	if (this->time==0){
		//do nothing, gazebo not running yet
		startTime = ros::Time::now().toSec();
		time = startTime;
	} else {
		double currTime = ros::Time::now().toSec()-startTime;
		//extract state
		geometry_msgs::Pose sPose = _msg->pose[1]; //use measurements from first robot (body 1 in Gazebo)
		geometry_msgs::Twist twist = _msg->twist[1];
		//form quaternion for orientation
		Quaterniond sensorOrientation = Quaterniond(sPose.orientation.w,sPose.orientation.x,sPose.orientation.y,sPose.orientation.z);

		Quaterniond bodyOrientation = Quaterniond(_msg->pose[0].orientation.w,_msg->pose[0].orientation.x,_msg->pose[0].orientation.y,_msg->pose[0].orientation.z);
		Matrix3d worldToBody = bodyOrientation.normalized().toRotationMatrix();
		//Matrix3d sensorToBody = (bodyOrientation.normalized().toRotationMatrix()).transpose()*sensorOrientation.normalized().toRotationMatrix();
		//express angular velocity in body frame
		//Vector3d angVel = sensorOrientation.normalized().toRotationMatrix().transpose()*Vector3d(twist.angular.x,twist.angular.y,twist.angular.z);
		//Vector3d linVel = sensorOrientation.normalized().toRotationMatrix().transpose()*Vector3d(twist.linear.x,twist.linear.y,twist.linear.z);

		//Vector3d angVel = sensorToBody*Vector3d(twist.angular.x,twist.angular.y,twist.angular.z);
		//Vector3d linVel = sensorToBody*Vector3d(twist.linear.x,twist.linear.y,twist.linear.z); 

		Vector3d angVel = worldToBody*Vector3d(twist.angular.x,twist.angular.y,twist.angular.z);
		Vector3d linVel = worldToBody*Vector3d(twist.linear.x,twist.linear.y,twist.linear.z); 

		//extract position + gibbs vector
		Vector3d pos;
		pos << sPose.position.x, sPose.position.y, sPose.position.z;
		Vector3d gibbs;
		gibbs << sPose.orientation.x/sPose.orientation.w, sPose.orientation.y/sPose.orientation.w, sPose.orientation.z/sPose.orientation.w;
		//pack q, qd
		Vector6d qCurr;
		qCurr << pos, gibbs;
		Vector6d qdCurr;
		qdCurr << linVel, angVel;
		//get reference trajectory
		Vector6d q_des, qd_des, qdd_des;
		//NEED TO PUT THESE IN BODY FRAME!
		//Also think about the rotation in gibbs vector components (not euler angles)
		q_des = q_d(currTime,bodyOrientation);
		qd_des = qd_d(currTime,bodyOrientation);
		qdd_des = qdd_d(currTime,bodyOrientation);
		//filter position/velocity

		// THIS FILTER IS NAIEVE -- need to treat quaternions as rotations + mix in that space.
		this->q =  1*qCurr + 0*this->q;
		this->qd = 1*qdCurr + 0*this->qd;
		//update adaptive controller params
		Vector6d q_t = this->q - q_des; //tracking error
		Vector6d qd_t = this->qd - qd_des;
		Vector6d s = qd_t + this->L*q_t;
		double dt = currTime - this->time;

		Vector6d sDead; //deadband error signal
		for(int i = 0; i < 6; i++){
			if(std::abs(q_t(i))<0.001){
				sDead(i) = 0.0;
			} else {
				sDead(i) = s(i);
			}

		}

		//this is mostly good, but controller diverges. need to check that all agents are applying forces in the correct frame etc. 

		MatrixXd Y = Ybody(this->q,this->qd,qd_des,qdd_des);

		Vector6d u = Y*this->a - this->Kd*sDead; //control vector in body frame

		this->a = this->a - dt*(this->Gamma*Y.transpose()*sDead);

		//need to put force into body frame
		

		//Vector3d fBody = sensorToBody*Vector3d(u(0),u(1),u(2));
		//Vector3d tBody = sensorToBody*Vector3d(u(3),u(4),u(5));
		Vector3d fBody = Vector3d(u(0),u(1),u(2));
		Vector3d tBody = Vector3d(u(3),u(4),u(5));

		//Vector3d fBody;
		//Vector3d tBody;

		//fBody << 0, 0, 0;
		//tBody << 0, 0, 0;

		geometry_msgs::Wrench cmdWrench;
		geometry_msgs::Vector3 force;
		geometry_msgs::Vector3 torque;
		orbit_sim::state state_msg;

		force.x = fBody(0);
		force.y = fBody(1);
		force.z = fBody(2);

		torque.x = tBody(0);
		torque.y = tBody(1);
		torque.z = tBody(2);

		cmdWrench.force = force;
		cmdWrench.torque = torque;

		std::vector<double> xmsg;
		std::vector<double> xm_msg;
		for(int i = 0; i < 6; i++){
			xmsg.push_back(this->q(i));
			xm_msg.push_back(q_des(i));
		}
		state_msg.x = xmsg;
		state_msg.xm = xm_msg;

		//express desired linear position in global frame
		//Vector3d q_des_lin = worldToBody.transpose()*q_des.head<3>();

		/*h.stamp = ros::Time::now();
		pose.header = h;
		path.header = h;
		pose.pose.position.x = q_des_lin(0);
		pose.pose.position.y = q_des_lin(1);
		pose.pose.position.z = q_des_lin(2);
		path.poses.push_back(pose);

		path_pub.publish(path);*/

		this->cmd_pub.publish(cmdWrench); //this should be in body frame
		this->state_pub.publish(state_msg);
		this->time = currTime;
	}
}

Vector6d q_d(double t,Quaterniond q){
	Vector3d q_des_lin, q_des_ang;
	for (int i =0 ; i < 6; i++){
		if (i == 5){ //past the last timestep
			//hold constant pose
			//ROS_INFO("trajectory finished!");
			q_des_lin = linCoefs.block(12,0,3,1)*pow(breaks[5]-breaks[4],3) + linCoefs.block(12,1,3,1)*pow(breaks[5]-breaks[4],2)+linCoefs.block(12,2,3,1)*(breaks[5]-breaks[4])+linCoefs.block(12,3,3,1);
			q_des_ang << 0, 0, 0;
			//q_des_ang = rotCoefs.block(12,0,3,1)*pow(breaks[5]-breaks[4],3) + rotCoefs.block(12,1,3,1)*pow(breaks[5]-breaks[4],2)+rotCoefs.block(12,2,3,1)*(breaks[5]-breaks[4])+rotCoefs.block(12,3,3,1);
		} else if ((t > breaks[i]) && (t < breaks[i+1])) { //in the ith segment of the spline
			q_des_lin = linCoefs.block(3*i,0,3,1)*pow(t-breaks[i],3) + linCoefs.block(3*i,1,3,1)*pow(t-breaks[i],2)+linCoefs.block(3*i,2,3,1)*(t-breaks[i])+linCoefs.block(3*i,3,3,1);
			//q_des_ang = rotCoefs.block(3*i,0,3,1)*pow(t-breaks[i],3) + rotCoefs.block(3*i,1,3,1)*pow(t-breaks[i],2)+rotCoefs.block(3*i,2,3,1)*(t-breaks[i])+rotCoefs.block(3*i,3,3,1);
			q_des_ang << 0, 0, 0;
			break;
		}
	}
	Vector6d q_des;
	Matrix3d worldToBody = q.normalized().toRotationMatrix();
	q_des << worldToBody*q_des_lin, q_des_ang;
	return q_des;
}

Vector6d qd_d(double t, Quaterniond q){
	Vector6d qd_des;
	Vector3d qd_des_lin, qd_des_ang;
	for (int i =0 ; i < 6; i++){
		if (i == 5){ //past the last timestep
			//hold constant pose
			qd_des_lin << 0, 0, 0;
			qd_des_ang << 0, 0, 0;
		} else if ((t > breaks[i]) && (t < breaks[i+1])) { //in the ith segment of the spline
			qd_des_lin = 3*linCoefs.block(3*i,0,3,1)*pow(t-breaks[i],2) + 2*linCoefs.block(3*i,1,3,1)*(t-breaks[i])+linCoefs.block(3*i,2,3,1);
			qd_des_ang << 0, 0, 0;
			//qd_des_ang = 3*rotCoefs.block(3*i,0,3,1)*pow(t-breaks[i],2) + 2*rotCoefs.block(3*i,1,3,1)*(t-breaks[i])+rotCoefs.block(3*i,2,3,1);
			break;
		}
	}
	Matrix3d worldToBody = q.normalized().toRotationMatrix();
	qd_des << worldToBody*qd_des_lin, qd_des_ang;
	return qd_des;
}

Vector6d qdd_d(double t, Quaterniond q){
	Vector6d qdd_des;
	Vector3d qdd_des_lin, qdd_des_ang;
	for (int i =0 ; i < 6; i++){
		if (i == 5){ //past the last timestep
			//hold constant pose
			qdd_des_lin << 0, 0, 0;
			qdd_des_ang << 0, 0, 0;
		} else if ((t > breaks[i]) && (t <= breaks[i+1])) { //in the ith segment of the spline
			qdd_des_lin = 6*linCoefs.block(3*i,0,3,1)*(t-breaks[i]) + 2*linCoefs.block(3*i,1,3,1);
			qdd_des_ang << 0, 0, 0;
			//qdd_des_ang = 6*rotCoefs.block(3*i,0,3,1)*(t-breaks[i]) + 2*rotCoefs.block(3*i,1,3,1);
			break;
		}
	}
	Matrix3d worldToBody = q.normalized().toRotationMatrix();
	qdd_des << worldToBody*qdd_des_lin, qdd_des_ang;
	return qdd_des;
}

MatrixXd Ybody(Vector6d q, Vector6d qd, Vector6d qd_d, Vector6d qdd_d){
    MatrixXd Yout(6,40);
    //ROS_INFO("trying to use Ybody");
    double qx = q[0], qy = q[1], qz = q[2], p1 = q[3], p2 = q[4], p3 = q[5];
    double qdx = qd[0], qdy = qd[1], qdz = qd[2], pd1 = qd[3], pd2 = qd[4], pd3 = qd[5];
    double qdx_d = qd_d[0], qdy_d = qd_d[1], qdz_d = qd_d[2], pd1_d = qd_d[3], pd2_d = qd_d[4], pd3_d = qd_d[5];
    double qddx_d = qdd_d[0], qddy_d = qdd_d[1], qddz_d = qdd_d[2], pdd1_d = qdd_d[3], pdd2_d = qdd_d[4], pdd3_d = qdd_d[5];
    Yout << 0, ((2*pdd3_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd3_d*((2*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd1_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p3*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) - pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)), (pd1_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p3*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) + pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + pd3_d*((2*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)), qddx_d, (pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) + (4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*p1*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)) + pd1_d*((4*p2*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) - (4*p3*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))), ((4*p3*pd1_d*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*pd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*pd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)), ((4*p1*pd2_d*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*pd3_d*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*p2*pd1_d*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), MatrixXd::Zero(1,33),
            (pd3_d*((2*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd3_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + pd1_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p3*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) + pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)), 0, ((2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd1_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p3*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) - pd2_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*pdd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)), qddy_d, ((4*p2*pd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*pd1_d*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*pd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)), (pd1_d*((4*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*p2*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)) - pd2_d*((4*p1*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) - (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) - (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2))), ((4*p1*pd2_d*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*pd3_d*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*p2*pd1_d*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), MatrixXd::Zero(1,33),
            ((2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd3_d*((2*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd1_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p3*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) - (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)), (pd1_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p3*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) - (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + pd2_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd3_d*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)), 0, qddz_d, ((4*p2*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*pd1_d*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)), ((4*p3*pd1_d*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) - (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), (pd1_d*((4*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*p3*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))) + pd3_d*((4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2))), MatrixXd::Zero(1,33),
            0, (-qddz_d), qddy_d, 0, 0, 0, 0, (- pd3_d*((4*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))) + pd2_d*((4*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*p1*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))) - (2*pd1_d*(2*pd3*pow(p1,3)*p2 - 2*pd2*pow(p1,3)*p3 + 2*pd2*pow(p1,2)*p2 + 2*pd3*pow(p1,2)*p3 - 2*pd3*p1*pow(p2,3) + 2*pd2*p1*pow(p2,2)*p3 + 2*pd3*p1*p2*pow(p3,2) + 2*pd3*p1*p2 - 2*pd2*p1*pow(p3,3) - 2*pd2*p1*p3 - 2*pd2*pow(p2,3) - 2*pd3*pow(p2,2)*p3 + 2*pd2*p2*pow(p3,2) + 2*pd2*p2 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd2_d*(- (2*p1*((2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + pd3_d*((2*((2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(pd3*pow(p1,4) - 2*pd1*pow(p1,3)*p3 - 2*pd3*pow(p1,2)*pow(p2,2) + 2*pd2*pow(p1,2)*p2*p3 + 2*pd1*pow(p1,2)*p2 + 2*pd3*pow(p1,2) - 2*pd1*p1*pow(p2,2)*p3 - 4*pd2*p1*pow(p2,2) - 2*pd1*p1*pow(p3,3) - 2*pd1*p1*p3 + pd3*pow(p2,4) - 2*pd2*pow(p2,3)*p3 + 2*pd1*pow(p2,3) - 4*pd3*pow(p2,2)*pow(p3,2) + 2*pd3*pow(p2,2) + 2*pd2*p2*pow(p3,3) + 2*pd1*p2*pow(p3,2) + 2*pd2*p2*p3 + 2*pd1*p2 - pd3*pow(p3,4) + pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- (2*pdd3_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pd1_d*(- pd2*pow(p1,4) + 2*pd1*pow(p1,3)*p2 + 2*pd1*pow(p1,2)*p3 - 2*pd2*pow(p1,2) + 2*pd1*p1*pow(p2,3) + 2*pd1*p1*p2*pow(p3,2) - 4*pd2*p1*p2*p3 + 2*pd1*p1*p2 + pd2*pow(p2,4) + 4*pd3*pow(p2,3)*p3 - 2*pd2*pow(p2,2)*pow(p3,2) + 2*pd1*pow(p2,2)*p3 + 4*pd3*p2*p3 + pd2*pow(p3,4) + 2*pd1*pow(p3,3) + 2*pd1*p3 - pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, (pd2_d*(- (2*p1*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + pd3_d*((2*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(- pd3*pow(p1,4) + 2*pd1*pow(p1,3)*p3 - 2*pd3*pow(p1,2) + 2*pd1*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p3,3) + 2*pd1*p1*p3 + pd3*pow(p2,4) + 2*pd3*pow(p2,2)*pow(p3,2) + pd3*pow(p3,4) - pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + pd2_d*(- (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd3_d*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pd1_d*(- pd2*pow(p1,4) + 2*pd1*pow(p1,3)*p2 + 2*pd3*pow(p1,2)*p2*p3 - 2*pd2*pow(p1,2)*pow(p3,2) - 2*pd2*pow(p1,2) + 2*pd1*p1*pow(p2,3) + 2*pd1*p1*p2*pow(p3,2) + 2*pd1*p1*p2 + pd2*pow(p2,4) + 2*pd3*pow(p2,3)*p3 + 2*pd3*p2*pow(p3,3) + 2*pd3*p2*p3 - pd2*pow(p3,4) - 2*pd2*pow(p3,2) - pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd3_d*(- (2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + pd2_d*((2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*pdd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(- 2*pd2*pow(p1,3)*p3 + 2*pd1*pow(p1,3) + 2*pd1*pow(p1,2)*p2*p3 + 4*pd3*pow(p1,2)*p3 - 2*pd2*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p2,2) - 2*pd2*p1*pow(p3,3) + 2*pd1*p1*pow(p3,2) - 2*pd2*p1*p3 + 2*pd1*p1 + 2*pd1*pow(p2,3)*p3 + 4*pd3*pow(p2,2)*p3 + 2*pd1*p2*pow(p3,3) + 2*pd1*p2*p3 + 4*pd3*pow(p3,3) + 4*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) - (4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (4*p1*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)) + (2*pd1_d*(- 2*pd2*pow(p1,3)*p2 + 2*pd3*pow(p1,3)*p3 + 2*pd1*pow(p1,2)*pow(p2,2) + 2*pd3*pow(p1,2)*p2 - 2*pd1*pow(p1,2)*pow(p3,2) + 2*pd2*pow(p1,2)*p3 - 2*pd2*p1*pow(p2,3) - 2*pd3*p1*pow(p2,2)*p3 + 2*pd2*p1*p2*pow(p3,2) - 2*pd2*p1*p2 + 2*pd3*p1*pow(p3,3) + 2*pd3*p1*p3 + 2*pd1*pow(p2,4) + 2*pd3*pow(p2,3) - 2*pd2*pow(p2,2)*p3 + 2*pd1*pow(p2,2) - 2*pd3*p2*pow(p3,2) + 2*pd3*p2 - 2*pd1*pow(p3,4) + 2*pd2*pow(p3,3) - 2*pd1*pow(p3,2) + 2*pd2*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, (- pd3_d*((2*((pd2 + p1*pd3 + p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd2_d*(- (2*p1*((pd2 + p1*pd3 + p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd3_d*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(2*pd1*pow(p1,3) + 2*pd3*pow(p1,2)*p3 + 2*pd1*p1*pow(p2,2) + 2*pd1*p1*pow(p3,2) + 2*pd1*p1 + 2*pd3*pow(p2,2)*p3 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, (- pd2_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*pdd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(2*pd3*pow(p1,3)*p2 + 2*pd1*pow(p1,3) - 2*pd1*pow(p1,2)*p2*p3 + 2*pd2*pow(p1,2)*p2 + 2*pd3*pow(p1,2)*p3 - 2*pd3*p1*pow(p2,3) + 4*pd2*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p2,2) + 2*pd3*p1*p2*pow(p3,2) + 2*pd3*p1*p2 + 2*pd1*p1*pow(p3,2) + 2*pd1*p1 - 2*pd1*pow(p2,3)*p3 - 2*pd2*pow(p2,3) - 2*pd3*pow(p2,2)*p3 - 2*pd1*p2*pow(p3,3) + 2*pd2*p2*pow(p3,2) - 2*pd1*p2*p3 + 2*pd2*p2 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, 0, (- pd3_d*((2*((pd2 + p1*pd3 + p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd2_d*(- (2*p1*((pd2 + p1*pd3 + p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd3_d*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(2*pd1*pow(p1,3) + 2*pd3*pow(p1,2)*p3 + 2*pd1*p1*pow(p2,2) + 2*pd1*p1*pow(p3,2) + 2*pd1*p1 + 2*pd3*pow(p2,2)*p3 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, (-qddz_d), qddy_d, 0, ((2*pd1_d*(- 2*pd2*pow(p1,3) + 2*pd1*pow(p1,2)*p2 + 2*pd3*pow(p1,2) - 2*pd2*p1*pow(p2,2) - 2*pd2*p1*pow(p3,2) - 2*pd2*p1 + 2*pd1*pow(p2,3) + 2*pd3*pow(p2,2) + 2*pd1*p2*pow(p3,2) + 2*pd1*p2 + 2*pd3*pow(p3,2) + 2*pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) + (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*p2*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), (- (4*pd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (2*pd1_d*(2*pd3*pow(p1,3) - 2*pd1*pow(p1,2)*p3 + 2*pd2*pow(p1,2) - 2*pd3*p1*pow(p2,2) + 4*pd2*p1*p2*p3 + 2*pd3*p1*pow(p3,2) + 2*pd3*p1 - 2*pd1*pow(p2,2)*p3 - 2*pd2*pow(p2,2) - 4*pd3*p2*p3 - 2*pd1*pow(p3,3) + 2*pd2*pow(p3,2) - 2*pd1*p3 + 2*pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) + (4*p2*pd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)), 0, (- (2*pd1_d*(- 2*pd2*pow(p1,3)*p3 + 2*pd1*pow(p1,2)*p2*p3 + 2*pd3*pow(p1,2)*p3 - 2*pd2*p1*pow(p2,2)*p3 - 2*pd2*p1*pow(p3,3) - 2*pd2*p1*p3 + 2*pd1*pow(p2,3)*p3 + 2*pd3*pow(p2,2)*p3 + 2*pd1*p2*pow(p3,3) + 2*pd1*p2*p3 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) + (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), (- pd2_d*((4*p1*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) - (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) - (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + (2*pd1_d*(- 2*pd2*pow(p1,3)*p2 + 2*pd1*pow(p1,2)*pow(p2,2) + 2*pd2*pow(p1,2)*p3 + 2*pd1*pow(p1,2) - 2*pd2*p1*pow(p2,3) - 2*pd2*p1*p2*pow(p3,2) - 6*pd2*p1*p2 + 2*pd1*pow(p2,4) + 4*pd3*pow(p2,3) + 2*pd1*pow(p2,2)*pow(p3,2) - 2*pd2*pow(p2,2)*p3 + 4*pd1*pow(p2,2) + 4*pd3*p2 + 2*pd2*pow(p3,3) + 2*pd1*pow(p3,2) + 2*pd2*p3 + 2*pd1))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, (- pd3_d*((4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - (2*pd1_d*(- 2*pd3*pow(p1,3)*p3 - 2*pd3*pow(p1,2)*p2 + 2*pd1*pow(p1,2)*pow(p3,2) + 2*pd1*pow(p1,2) + 2*pd3*p1*pow(p2,2)*p3 - 4*pd2*p1*p2*pow(p3,2) - 4*pd2*p1*p2 - 2*pd3*p1*pow(p3,3) - 2*pd3*p1*p3 + 2*pd3*pow(p2,3) + 2*pd1*pow(p2,2)*pow(p3,2) + 2*pd1*pow(p2,2) + 2*pd3*p2*pow(p3,2) + 2*pd3*p2 + 2*pd1*pow(p3,4) + 4*pd1*pow(p3,2) + 2*pd1))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- (2*pd1_d*(2*pd3*pow(p1,3)*p2 - 2*pd1*pow(p1,2)*p2*p3 + 2*pd2*pow(p1,2)*p2 - 2*pd3*p1*pow(p2,3) + 4*pd2*p1*pow(p2,2)*p3 + 2*pd3*p1*p2*pow(p3,2) + 2*pd3*p1*p2 - 2*pd1*pow(p2,3)*p3 - 2*pd2*pow(p2,3) - 4*pd3*pow(p2,2)*p3 - 2*pd1*p2*pow(p3,3) + 2*pd2*p2*pow(p3,2) - 2*pd1*p2*p3 + 2*pd2*p2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) - (4*pd3_d*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*p1*pd2_d*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), ((2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd2_d*(- (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*pdd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(2*pd1*pow(p1,3) + 2*pd3*pow(p1,2)*p3 + 2*pd1*p1*pow(p2,2) + 2*pd1*p1*pow(p3,2) + 2*pd1*p1 + 2*pd3*pow(p2,2)*p3 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- pd2_d*(- (2*p1*((2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd3_d*((2*((2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(pd3*pow(p1,4) - 2*pd1*pow(p1,3)*p3 - 2*pd3*pow(p1,2)*pow(p2,2) + 2*pd2*pow(p1,2)*p2*p3 + 2*pd1*pow(p1,2)*p2 + 2*pd3*pow(p1,2) - 2*pd1*p1*pow(p2,2)*p3 - 4*pd2*p1*pow(p2,2) - 2*pd1*p1*pow(p3,3) - 2*pd1*p1*p3 + pd3*pow(p2,4) - 2*pd2*pow(p2,3)*p3 + 2*pd1*pow(p2,3) - 4*pd3*pow(p2,2)*pow(p3,2) + 2*pd3*pow(p2,2) + 2*pd2*p2*pow(p3,3) + 2*pd1*p2*pow(p3,2) + 2*pd2*p2*p3 + 2*pd1*p2 - pd3*pow(p3,4) + pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), ((2*pdd3_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pd1_d*(- pd2*pow(p1,4) + 2*pd1*pow(p1,3)*p2 + 2*pd1*pow(p1,2)*p3 - 2*pd2*pow(p1,2) + 2*pd1*p1*pow(p2,3) + 2*pd1*p1*p2*pow(p3,2) - 4*pd2*p1*p2*p3 + 2*pd1*p1*p2 + pd2*pow(p2,4) + 4*pd3*pow(p2,3)*p3 - 2*pd2*pow(p2,2)*pow(p3,2) + 2*pd1*pow(p2,2)*p3 + 4*pd3*p2*p3 + pd2*pow(p3,4) + 2*pd1*pow(p3,3) + 2*pd1*p3 - pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- (2*pd1_d*(2*pd3*pow(p1,3)*p2 - 2*pd1*pow(p1,2)*p2*p3 + 2*pd2*pow(p1,2)*p2 - 2*pd3*p1*pow(p2,3) + 4*pd2*p1*pow(p2,2)*p3 + 2*pd3*p1*p2*pow(p3,2) + 2*pd3*p1*p2 - 2*pd1*pow(p2,3)*p3 - 2*pd2*pow(p2,3) - 4*pd3*pow(p2,2)*p3 - 2*pd1*p2*pow(p3,3) + 2*pd2*p2*pow(p3,2) - 2*pd1*p2*p3 + 2*pd2*p2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) - (4*pd3_d*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*p1*pd2_d*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), (- pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) - (4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (4*p1*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)) - (2*pd1_d*(- 2*pd2*pow(p1,3)*p2 + 2*pd3*pow(p1,3)*p3 + 2*pd1*pow(p1,2)*pow(p2,2) + 2*pd3*pow(p1,2)*p2 - 2*pd1*pow(p1,2)*pow(p3,2) + 2*pd2*pow(p1,2)*p3 - 2*pd2*p1*pow(p2,3) - 2*pd3*p1*pow(p2,2)*p3 + 2*pd2*p1*p2*pow(p3,2) - 2*pd2*p1*p2 + 2*pd3*p1*pow(p3,3) + 2*pd3*p1*p3 + 2*pd1*pow(p2,4) + 2*pd3*pow(p2,3) - 2*pd2*pow(p2,2)*p3 + 2*pd1*pow(p2,2) - 2*pd3*p2*pow(p3,2) + 2*pd3*p2 - 2*pd1*pow(p3,4) + 2*pd2*pow(p3,3) - 2*pd1*pow(p3,2) + 2*pd2*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- (2*pd1_d*(- 2*pd2*pow(p1,3)*p3 + 2*pd1*pow(p1,2)*p2*p3 + 2*pd3*pow(p1,2)*p3 - 2*pd2*p1*pow(p2,2)*p3 - 2*pd2*p1*pow(p3,3) - 2*pd2*p1*p3 + 2*pd1*pow(p2,3)*p3 + 2*pd3*pow(p2,2)*p3 + 2*pd1*p2*pow(p3,3) + 2*pd1*p2*p3 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) + (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))),
            qddz_d, 0, (-qddx_d), 0, 0, 0, 0, (- pd3_d*((2*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd2_d*((2*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(- pd3*pow(p1,4) + 2*pd1*pow(p1,3)*p3 + 2*pd2*pow(p1,3) - 2*pd1*pow(p1,2)*p2 - 4*pd3*pow(p1,2) + 2*pd1*p1*pow(p2,2)*p3 + 2*pd2*p1*pow(p2,2) + 2*pd1*p1*pow(p3,3) + 2*pd2*p1*pow(p3,2) + 2*pd1*p1*p3 + 2*pd2*p1 + pd3*pow(p2,4) - 2*pd1*pow(p2,3) + 2*pd3*pow(p2,2)*pow(p3,2) - 2*pd3*pow(p2,2) - 2*pd1*p2*pow(p3,2) - 2*pd1*p2 + pd3*pow(p3,4) - 2*pd3*pow(p3,2) - 3*pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd2_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pdd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(- 2*pd3*pow(p1,3)*p2 + 2*pd1*pow(p1,3) + 2*pd1*pow(p1,2)*p2*p3 - 2*pd2*pow(p1,2)*p2 + 2*pd3*pow(p1,2)*p3 + 2*pd3*p1*pow(p2,3) - 4*pd2*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p2,2) - 2*pd3*p1*p2*pow(p3,2) - 2*pd3*p1*p2 + 2*pd1*p1*pow(p3,2) + 2*pd1*p1 + 2*pd1*pow(p2,3)*p3 + 2*pd2*pow(p2,3) + 6*pd3*pow(p2,2)*p3 + 2*pd1*p2*pow(p3,3) - 2*pd2*p2*pow(p3,2) + 2*pd1*p2*p3 - 2*pd2*p2 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd2_d*((4*p1*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) + (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) + (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + (2*pd1_d*(2*pd2*pow(p1,3)*p2 - 2*pd1*pow(p1,2)*pow(p2,2) - 4*pd3*pow(p1,2)*p2 + 2*pd2*pow(p1,2)*p3 + 2*pd1*pow(p1,2) + 2*pd2*p1*pow(p2,3) + 2*pd2*p1*p2*pow(p3,2) - 2*pd2*p1*p2 - 2*pd1*pow(p2,4) - 2*pd1*pow(p2,2)*pow(p3,2) - 2*pd2*pow(p2,2)*p3 - 4*pd3*p2*pow(p3,2) + 2*pd2*pow(p3,3) + 2*pd1*pow(p3,2) + 2*pd2*p3 + 2*pd1))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- pd2_d*(- (2*p1*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd3_d*((2*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(- pd3*pow(p1,4) + 2*pd1*pow(p1,3)*p3 - 2*pd3*pow(p1,2) + 2*pd1*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p3,3) + 2*pd1*p1*p3 + pd3*pow(p2,4) + 2*pd3*pow(p2,2)*pow(p3,2) + pd3*pow(p3,4) - pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, 0, (- pd2_d*((4*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*p1*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))) + pd3_d*((4*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*p2*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))) - (2*pd1_d*(- 2*pd2*pow(p1,3) + 2*pd3*pow(p1,2)*pow(p2,2) - 2*pd2*pow(p1,2)*p2*p3 + 2*pd3*pow(p1,2) + 2*pd2*p1*pow(p2,2) - 2*pd2*p1*pow(p3,2) - 2*pd2*p1 - 2*pd3*pow(p2,4) + 2*pd2*pow(p2,3)*p3 + 2*pd3*pow(p2,2)*pow(p3,2) - 2*pd2*p2*pow(p3,3) - 2*pd2*p2*p3 + 2*pd3*pow(p3,2) + 2*pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- (2*pdd3_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + pd2_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) + pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pd1_d*(- pd2*pow(p1,4) + 2*pd1*pow(p1,3)*p2 + 2*pd3*pow(p1,3) + 2*pd3*pow(p1,2)*p2*p3 - 2*pd2*pow(p1,2)*pow(p3,2) - 2*pd1*pow(p1,2)*p3 + 2*pd1*p1*pow(p2,3) - 2*pd3*p1*pow(p2,2) + 2*pd1*p1*p2*pow(p3,2) + 4*pd2*p1*p2*p3 + 2*pd1*p1*p2 + 2*pd3*p1*pow(p3,2) + 2*pd3*p1 + pd2*pow(p2,4) + 2*pd3*pow(p2,3)*p3 - 2*pd1*pow(p2,2)*p3 - 2*pd2*pow(p2,2) + 2*pd3*p2*pow(p3,3) - 2*pd3*p2*p3 - pd2*pow(p3,4) - 2*pd1*pow(p3,3) - 2*pd1*p3 + pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd3_d*((2*((pd2 + p1*pd3 + p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + pd2_d*(- (2*p1*((pd2 + p1*pd3 + p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd3_d*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(2*pd1*pow(p1,3) + 2*pd3*pow(p1,2)*p3 + 2*pd1*p1*pow(p2,2) + 2*pd1*p1*pow(p3,2) + 2*pd1*p1 + 2*pd3*pow(p2,2)*p3 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, (pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + pd2_d*(- (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd3_d*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pd1_d*(- pd2*pow(p1,4) + 2*pd1*pow(p1,3)*p2 + 2*pd3*pow(p1,2)*p2*p3 - 2*pd2*pow(p1,2)*pow(p3,2) - 2*pd2*pow(p1,2) + 2*pd1*p1*pow(p2,3) + 2*pd1*p1*p2*pow(p3,2) + 2*pd1*p1*p2 + pd2*pow(p2,4) + 2*pd3*pow(p2,3)*p3 + 2*pd3*p2*pow(p3,3) + 2*pd3*p2*p3 - pd2*pow(p3,4) - 2*pd2*pow(p3,2) - pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- pd2_d*((2*p1*((2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + pd3_d*((2*((2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(- pd3*pow(p1,4) + 2*pd1*pow(p1,3)*p3 - 2*pd3*pow(p1,2)*pow(p2,2) + 2*pd2*pow(p1,2)*p2*p3 + 2*pd1*pow(p1,2)*p2 - 2*pd3*pow(p1,2) + 2*pd1*p1*pow(p2,2)*p3 - 4*pd2*p1*pow(p2,2) + 2*pd1*p1*pow(p3,3) + 2*pd1*p1*p3 + 3*pd3*pow(p2,4) - 2*pd2*pow(p2,3)*p3 + 2*pd1*pow(p2,3) + 2*pd3*pow(p2,2) + 2*pd2*p2*pow(p3,3) + 2*pd1*p2*pow(p3,2) + 2*pd2*p2*p3 + 2*pd1*p2 + pd3*pow(p3,4) - pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, 0, (- pd2_d*(- (2*p1*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd3_d*((2*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(- pd3*pow(p1,4) + 2*pd1*pow(p1,3)*p3 - 2*pd3*pow(p1,2) + 2*pd1*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p3,3) + 2*pd1*p1*p3 + pd3*pow(p2,4) + 2*pd3*pow(p2,2)*pow(p3,2) + pd3*pow(p3,4) - pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), qddz_d, 0, (-qddx_d), (- (2*pd1_d*(- 2*pd2*pow(p1,3) + 2*pd1*pow(p1,2)*p2 + 2*pd3*pow(p1,2) - 2*pd2*p1*pow(p2,2) - 2*pd2*p1*pow(p3,2) - 2*pd2*p1 + 2*pd1*pow(p2,3) + 2*pd3*pow(p2,2) + 2*pd1*p2*pow(p3,2) + 2*pd1*p2 + 2*pd3*pow(p3,2) + 2*pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) - (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*p2*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), 0, (- pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) + (4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*p1*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)) - (2*pd1_d*(- 2*pd2*pow(p1,3)*p2 - 2*pd3*pow(p1,3)*p3 + 2*pd1*pow(p1,2)*pow(p2,2) + 2*pd3*pow(p1,2)*p2 + 2*pd1*pow(p1,2)*pow(p3,2) - 2*pd2*pow(p1,2)*p3 - 2*pd2*p1*pow(p2,3) + 2*pd3*p1*pow(p2,2)*p3 - 6*pd2*p1*p2*pow(p3,2) - 2*pd2*p1*p2 - 2*pd3*p1*pow(p3,3) - 2*pd3*p1*p3 + 2*pd1*pow(p2,4) + 2*pd3*pow(p2,3) + 4*pd1*pow(p2,2)*pow(p3,2) + 2*pd2*pow(p2,2)*p3 + 2*pd1*pow(p2,2) + 6*pd3*p2*pow(p3,2) + 2*pd3*p2 + 2*pd1*pow(p3,4) - 2*pd2*pow(p3,3) + 2*pd1*pow(p3,2) - 2*pd2*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), ((2*pd1_d*(- 2*pd2*pow(p1,3)*p3 + 2*pd1*pow(p1,2)*p2*p3 + 2*pd3*pow(p1,2)*p3 - 2*pd2*p1*pow(p2,2)*p3 - 2*pd2*p1*pow(p3,3) - 2*pd2*p1*p3 + 2*pd1*pow(p2,3)*p3 + 2*pd3*pow(p2,2)*p3 + 2*pd1*p2*pow(p3,3) + 2*pd1*p2*p3 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) - (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), 0, ((4*pd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (2*pd1_d*(- 2*pd3*pow(p1,2)*p2*p3 + 2*pd2*pow(p1,2)*pow(p3,2) + 2*pd1*pow(p1,2)*p3 - 4*pd2*p1*p2*p3 + 2*pd3*pow(p2,3)*p3 - 2*pd2*pow(p2,2)*pow(p3,2) + 2*pd1*pow(p2,2)*p3 - 2*pd3*p2*pow(p3,3) + 2*pd3*p2*p3 + 2*pd2*pow(p3,4) + 2*pd1*pow(p3,3) + 2*pd2*pow(p3,2) + 2*pd1*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) + (4*pd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)), (pd3_d*((4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + (2*pd1_d*(- 2*pd3*pow(p1,3)*p3 - 2*pd3*pow(p1,2)*p2 + 2*pd1*pow(p1,2)*pow(p3,2) + 2*pd1*pow(p1,2) + 2*pd3*p1*pow(p2,2)*p3 - 4*pd2*p1*p2*pow(p3,2) - 4*pd2*p1*p2 - 2*pd3*p1*pow(p3,3) - 2*pd3*p1*p3 + 2*pd3*pow(p2,3) + 2*pd1*pow(p2,2)*pow(p3,2) + 2*pd1*pow(p2,2) + 2*pd3*p2*pow(p3,2) + 2*pd3*p2 + 2*pd1*pow(p3,4) + 4*pd1*pow(p3,2) + 2*pd1))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, ((2*pd1_d*(- 2*pd3*pow(p1,2)*pow(p2,2) + 2*pd2*pow(p1,2)*p2*p3 + 2*pd1*pow(p1,2)*p2 - 4*pd2*p1*pow(p2,2) + 2*pd3*pow(p2,4) - 2*pd2*pow(p2,3)*p3 + 2*pd1*pow(p2,3) - 2*pd3*pow(p2,2)*pow(p3,2) + 2*pd3*pow(p2,2) + 2*pd2*p2*pow(p3,3) + 2*pd1*p2*pow(p3,2) + 2*pd2*p2*p3 + 2*pd1*p2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) + (4*pd3_d*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*p1*pd2_d*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), ((2*pd1_d*(- 2*pd3*pow(p1,2)*pow(p2,2) + 2*pd2*pow(p1,2)*p2*p3 + 2*pd1*pow(p1,2)*p2 - 4*pd2*p1*pow(p2,2) + 2*pd3*pow(p2,4) - 2*pd2*pow(p2,3)*p3 + 2*pd1*pow(p2,3) - 2*pd3*pow(p2,2)*pow(p3,2) + 2*pd3*pow(p2,2) + 2*pd2*p2*pow(p3,3) + 2*pd1*p2*pow(p3,2) + 2*pd2*p2*p3 + 2*pd1*p2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) + (4*pd3_d*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*p1*pd2_d*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), (- pd2_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*pdd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(- 2*pd3*pow(p1,3)*p2 + 2*pd1*pow(p1,3) + 2*pd1*pow(p1,2)*p2*p3 - 2*pd2*pow(p1,2)*p2 + 2*pd3*pow(p1,2)*p3 + 2*pd3*p1*pow(p2,3) - 4*pd2*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p2,2) - 2*pd3*p1*p2*pow(p3,2) - 2*pd3*p1*p2 + 2*pd1*p1*pow(p3,2) + 2*pd1*p1 + 2*pd1*pow(p2,3)*p3 + 2*pd2*pow(p2,3) + 6*pd3*pow(p2,2)*p3 + 2*pd1*p2*pow(p3,3) - 2*pd2*p2*pow(p3,2) + 2*pd1*p2*p3 - 2*pd2*p2 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- pd2_d*((4*p1*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) + (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) + (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - (2*pd1_d*(2*pd2*pow(p1,3)*p2 - 2*pd1*pow(p1,2)*pow(p2,2) - 4*pd3*pow(p1,2)*p2 + 2*pd2*pow(p1,2)*p3 + 2*pd1*pow(p1,2) + 2*pd2*p1*pow(p2,3) + 2*pd2*p1*p2*pow(p3,2) - 2*pd2*p1*p2 - 2*pd1*pow(p2,4) - 2*pd1*pow(p2,2)*pow(p3,2) - 2*pd2*pow(p2,2)*p3 - 4*pd3*p2*pow(p3,2) + 2*pd2*pow(p3,3) + 2*pd1*pow(p3,2) + 2*pd2*p3 + 2*pd1))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- pd2_d*((2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd3_d*((2*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(- pd3*pow(p1,4) + 2*pd1*pow(p1,3)*p3 - 2*pd3*pow(p1,2) + 2*pd1*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p3,3) + 2*pd1*p1*p3 + pd3*pow(p2,4) + 2*pd3*pow(p2,2)*pow(p3,2) + pd3*pow(p3,4) - pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), ((2*pdd3_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd2_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) - pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pd1_d*(- pd2*pow(p1,4) + 2*pd1*pow(p1,3)*p2 + 2*pd3*pow(p1,3) + 2*pd3*pow(p1,2)*p2*p3 - 2*pd2*pow(p1,2)*pow(p3,2) - 2*pd1*pow(p1,2)*p3 + 2*pd1*p1*pow(p2,3) - 2*pd3*p1*pow(p2,2) + 2*pd1*p1*p2*pow(p3,2) + 4*pd2*p1*p2*p3 + 2*pd1*p1*p2 + 2*pd3*p1*pow(p3,2) + 2*pd3*p1 + pd2*pow(p2,4) + 2*pd3*pow(p2,3)*p3 - 2*pd1*pow(p2,2)*p3 - 2*pd2*pow(p2,2) + 2*pd3*p2*pow(p3,3) - 2*pd3*p2*p3 - pd2*pow(p3,4) - 2*pd1*pow(p3,3) - 2*pd1*p3 + pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- (2*pd1_d*(- 2*pd2*pow(p1,3) + 2*pd1*pow(p1,2)*p2 + 2*pd3*pow(p1,2) - 2*pd2*p1*pow(p2,2) - 2*pd2*p1*pow(p3,2) - 2*pd2*p1 + 2*pd1*pow(p2,3) + 2*pd3*pow(p2,2) + 2*pd1*p2*pow(p3,2) + 2*pd1*p2 + 2*pd3*pow(p3,2) + 2*pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) - (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*p2*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))),
            (-qddy_d), qddx_d, 0, 0, 0, 0, 0, ((2*pdd3_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd2_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) - pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pd1_d*(- pd2*pow(p1,4) + 2*pd1*pow(p1,3)*p2 - 2*pd3*pow(p1,3) + 2*pd3*pow(p1,2)*p2*p3 - 2*pd2*pow(p1,2)*pow(p3,2) + 2*pd1*pow(p1,2)*p3 - 4*pd2*pow(p1,2) + 2*pd1*p1*pow(p2,3) + 2*pd3*p1*pow(p2,2) + 2*pd1*p1*p2*pow(p3,2) - 4*pd2*p1*p2*p3 + 2*pd1*p1*p2 - 2*pd3*p1*pow(p3,2) - 2*pd3*p1 + pd2*pow(p2,4) + 2*pd3*pow(p2,3)*p3 + 2*pd1*pow(p2,2)*p3 + 2*pd2*pow(p2,2) + 2*pd3*p2*pow(p3,3) + 6*pd3*p2*p3 - pd2*pow(p3,4) + 2*pd1*pow(p3,3) - 4*pd2*pow(p3,2) + 2*pd1*p3 - 3*pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd3_d*((4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - (2*pd1_d*(2*pd3*pow(p1,3)*p3 - 2*pd3*pow(p1,2)*p2 - 2*pd1*pow(p1,2)*pow(p3,2) + 4*pd2*pow(p1,2)*p3 + 2*pd1*pow(p1,2) - 2*pd3*p1*pow(p2,2)*p3 + 4*pd2*p1*p2*pow(p3,2) - 4*pd2*p1*p2 + 2*pd3*p1*pow(p3,3) + 2*pd3*p1*p3 + 2*pd3*pow(p2,3) - 2*pd1*pow(p2,2)*pow(p3,2) - 4*pd2*pow(p2,2)*p3 + 2*pd1*pow(p2,2) - 6*pd3*p2*pow(p3,2) + 2*pd3*p2 - 2*pd1*pow(p3,4) + 4*pd2*pow(p3,3) + 4*pd2*p3 + 2*pd1))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + pd2_d*(- (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pdd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(2*pd2*pow(p1,3)*p3 + 2*pd1*pow(p1,3) - 2*pd1*pow(p1,2)*p2*p3 + 2*pd2*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p2,2) + 2*pd2*p1*pow(p3,3) + 2*pd1*p1*pow(p3,2) + 2*pd2*p1*p3 + 2*pd1*p1 - 2*pd1*pow(p2,3)*p3 - 2*pd1*p2*pow(p3,3) - 2*pd1*p2*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd2_d*(- (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd3_d*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pd1_d*(- pd2*pow(p1,4) + 2*pd1*pow(p1,3)*p2 + 2*pd3*pow(p1,2)*p2*p3 - 2*pd2*pow(p1,2)*pow(p3,2) - 2*pd2*pow(p1,2) + 2*pd1*p1*pow(p2,3) + 2*pd1*p1*p2*pow(p3,2) + 2*pd1*p1*p2 + pd2*pow(p2,4) + 2*pd3*pow(p2,3)*p3 + 2*pd3*p2*pow(p3,3) + 2*pd3*p2*p3 - pd2*pow(p3,4) - 2*pd2*pow(p3,2) - pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, 0, ((2*pdd3_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pd1_d*(pd2*pow(p1,4) - 2*pd1*pow(p1,3)*p2 - 4*pd3*pow(p1,2)*p2*p3 + 4*pd2*pow(p1,2)*pow(p3,2) + 2*pd1*pow(p1,2)*p3 + 2*pd2*pow(p1,2) - 2*pd1*p1*pow(p2,3) - 2*pd1*p1*p2*pow(p3,2) - 4*pd2*p1*p2*p3 - 2*pd1*p1*p2 - pd2*pow(p2,4) - 2*pd2*pow(p2,2)*pow(p3,2) + 2*pd1*pow(p2,2)*p3 - 4*pd3*p2*pow(p3,3) + 3*pd2*pow(p3,4) + 2*pd1*pow(p3,3) + 4*pd2*pow(p3,2) + 2*pd1*p3 + pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd3_d*((2*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd2_d*((2*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) - (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(- pd3*pow(p1,4) + 2*pd1*pow(p1,3)*p3 - 2*pd2*pow(p1,3) + 2*pd1*pow(p1,2)*p2 + 2*pd1*p1*pow(p2,2)*p3 - 2*pd2*p1*pow(p2,2) + 2*pd1*p1*pow(p3,3) - 2*pd2*p1*pow(p3,2) + 2*pd1*p1*p3 - 2*pd2*p1 + pd3*pow(p2,4) + 2*pd1*pow(p2,3) + 2*pd3*pow(p2,2)*pow(p3,2) + 2*pd3*pow(p2,2) + 2*pd1*p2*pow(p3,2) + 2*pd1*p2 + pd3*pow(p3,4) + 2*pd3*pow(p3,2) + pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, (- pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - pd2_d*(- (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd3_d*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pd1_d*(- pd2*pow(p1,4) + 2*pd1*pow(p1,3)*p2 + 2*pd3*pow(p1,2)*p2*p3 - 2*pd2*pow(p1,2)*pow(p3,2) - 2*pd2*pow(p1,2) + 2*pd1*p1*pow(p2,3) + 2*pd1*p1*p2*pow(p3,2) + 2*pd1*p1*p2 + pd2*pow(p2,4) + 2*pd3*pow(p2,3)*p3 + 2*pd3*p2*pow(p3,3) + 2*pd3*p2*p3 - pd2*pow(p3,4) - 2*pd2*pow(p3,2) - pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, (- pd3_d*((4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + (2*pd1_d*(2*pd3*pow(p1,3) - 2*pd3*pow(p1,2)*p2*p3 + 2*pd2*pow(p1,2)*pow(p3,2) + 2*pd2*pow(p1,2) - 2*pd3*p1*pow(p2,2) + 2*pd3*p1*pow(p3,2) + 2*pd3*p1 + 2*pd3*pow(p2,3)*p3 - 2*pd2*pow(p2,2)*pow(p3,2) - 2*pd2*pow(p2,2) - 2*pd3*p2*pow(p3,3) - 2*pd3*p2*p3 + 2*pd2*pow(p3,4) + 4*pd2*pow(p3,2) + 2*pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd3_d*((2*((pd2 + p1*pd3 + p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + pd2_d*(- (2*p1*((pd2 + p1*pd3 + p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd3_d*(- pow(p1,2)*p2 + pow(p2,3) - p2*pow(p3,2) + p2))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(2*pd1*pow(p1,3) + 2*pd3*pow(p1,2)*p3 + 2*pd1*p1*pow(p2,2) + 2*pd1*p1*pow(p3,2) + 2*pd1*p1 + 2*pd3*pow(p2,2)*p3 + 2*pd3*pow(p3,3) + 2*pd3*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (pd2_d*(- (2*p1*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + pd3_d*((2*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(- pd3*pow(p1,4) + 2*pd1*pow(p1,3)*p3 - 2*pd3*pow(p1,2) + 2*pd1*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p3,3) + 2*pd1*p1*p3 + pd3*pow(p2,4) + 2*pd3*pow(p2,2)*pow(p3,2) + pd3*pow(p3,4) - pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, (-qddy_d), qddx_d, 0, ((4*pd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (2*pd1_d*(2*pd3*pow(p1,3) - 2*pd1*pow(p1,2)*p3 + 2*pd2*pow(p1,2) - 2*pd3*p1*pow(p2,2) + 4*pd2*p1*p2*p3 + 2*pd3*p1*pow(p3,2) + 2*pd3*p1 - 2*pd1*pow(p2,2)*p3 - 2*pd2*pow(p2,2) - 4*pd3*p2*p3 - 2*pd1*pow(p3,3) + 2*pd2*pow(p3,2) - 2*pd1*p3 + 2*pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) - (4*p2*pd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)), (pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) + (4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*p1*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)) + (2*pd1_d*(- 2*pd2*pow(p1,3)*p2 - 2*pd3*pow(p1,3)*p3 + 2*pd1*pow(p1,2)*pow(p2,2) + 2*pd3*pow(p1,2)*p2 + 2*pd1*pow(p1,2)*pow(p3,2) - 2*pd2*pow(p1,2)*p3 - 2*pd2*p1*pow(p2,3) + 2*pd3*p1*pow(p2,2)*p3 - 6*pd2*p1*p2*pow(p3,2) - 2*pd2*p1*p2 - 2*pd3*p1*pow(p3,3) - 2*pd3*p1*p3 + 2*pd1*pow(p2,4) + 2*pd3*pow(p2,3) + 4*pd1*pow(p2,2)*pow(p3,2) + 2*pd2*pow(p2,2)*p3 + 2*pd1*pow(p2,2) + 6*pd3*p2*pow(p3,2) + 2*pd3*p2 + 2*pd1*pow(p3,4) - 2*pd2*pow(p3,3) + 2*pd1*pow(p3,2) - 2*pd2*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), 0, (pd2_d*((4*p1*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) - (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2) - (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - (2*pd1_d*(- 2*pd2*pow(p1,3)*p2 + 2*pd1*pow(p1,2)*pow(p2,2) + 2*pd2*pow(p1,2)*p3 + 2*pd1*pow(p1,2) - 2*pd2*p1*pow(p2,3) - 2*pd2*p1*p2*pow(p3,2) - 6*pd2*p1*p2 + 2*pd1*pow(p2,4) + 4*pd3*pow(p2,3) + 2*pd1*pow(p2,2)*pow(p3,2) - 2*pd2*pow(p2,2)*p3 + 4*pd1*pow(p2,2) + 4*pd3*p2 + 2*pd2*pow(p3,3) + 2*pd1*pow(p3,2) + 2*pd2*p3 + 2*pd1))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- (4*pd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (2*pd1_d*(- 2*pd3*pow(p1,2)*p2*p3 + 2*pd2*pow(p1,2)*pow(p3,2) + 2*pd1*pow(p1,2)*p3 - 4*pd2*p1*p2*p3 + 2*pd3*pow(p2,3)*p3 - 2*pd2*pow(p2,2)*pow(p3,2) + 2*pd1*pow(p2,2)*p3 - 2*pd3*p2*pow(p3,3) + 2*pd3*p2*p3 + 2*pd2*pow(p3,4) + 2*pd1*pow(p3,3) + 2*pd2*pow(p3,2) + 2*pd1*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) - (4*pd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)), 0, ((2*pd1_d*(2*pd3*pow(p1,3)*p2 - 2*pd1*pow(p1,2)*p2*p3 + 2*pd2*pow(p1,2)*p2 - 2*pd3*p1*pow(p2,3) + 4*pd2*p1*pow(p2,2)*p3 + 2*pd3*p1*p2*pow(p3,2) + 2*pd3*p1*p2 - 2*pd1*pow(p2,3)*p3 - 2*pd2*pow(p2,3) - 4*pd3*pow(p2,2)*p3 - 2*pd1*p2*pow(p3,3) + 2*pd2*p2*pow(p3,2) - 2*pd1*p2*p3 + 2*pd2*p2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) + (4*pd3_d*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (4*p1*pd2_d*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), (- (2*pd1_d*(- 2*pd3*pow(p1,2)*pow(p2,2) + 2*pd2*pow(p1,2)*p2*p3 + 2*pd1*pow(p1,2)*p2 - 4*pd2*p1*pow(p2,2) + 2*pd3*pow(p2,4) - 2*pd2*pow(p2,3)*p3 + 2*pd1*pow(p2,3) - 2*pd3*pow(p2,2)*pow(p3,2) + 2*pd3*pow(p2,2) + 2*pd2*p2*pow(p3,3) + 2*pd1*p2*pow(p3,2) + 2*pd2*p2*p3 + 2*pd1*p2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) - (4*pd3_d*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (4*p1*pd2_d*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)*(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))), 0, (- (4*pd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (2*pd1_d*(- 2*pd3*pow(p1,2)*p2*p3 + 2*pd2*pow(p1,2)*pow(p3,2) + 2*pd1*pow(p1,2)*p3 - 4*pd2*p1*p2*p3 + 2*pd3*pow(p2,3)*p3 - 2*pd2*pow(p2,2)*pow(p3,2) + 2*pd1*pow(p2,2)*p3 - 2*pd3*p2*pow(p3,3) + 2*pd3*p2*p3 + 2*pd2*pow(p3,4) + 2*pd1*pow(p3,3) + 2*pd2*pow(p3,2) + 2*pd1*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) - (4*pd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)), (- pd3_d*((4*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (4*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) - pd2_d*((4*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) - (4*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(- pd3*pow(p1,2)*p2 + pd2*pow(p1,2)*p3 + pd1*pow(p1,2) - 2*pd2*p1*p2 + pd3*pow(p2,3) - pd2*pow(p2,2)*p3 + pd1*pow(p2,2) - pd3*p2*pow(p3,2) + pd3*p2 + pd2*pow(p3,3) + pd1*pow(p3,2) + pd2*p3 + pd1))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)) + (2*pd1_d*(2*pd3*pow(p1,3)*p3 - 2*pd3*pow(p1,2)*p2 - 2*pd1*pow(p1,2)*pow(p3,2) + 4*pd2*pow(p1,2)*p3 + 2*pd1*pow(p1,2) - 2*pd3*p1*pow(p2,2)*p3 + 4*pd2*p1*p2*pow(p3,2) - 4*pd2*p1*p2 + 2*pd3*p1*pow(p3,3) + 2*pd3*p1*p3 + 2*pd3*pow(p2,3) - 2*pd1*pow(p2,2)*pow(p3,2) - 4*pd2*pow(p2,2)*p3 + 2*pd1*pow(p2,2) - 6*pd3*p2*pow(p3,2) + 2*pd3*p2 - 2*pd1*pow(p3,4) + 4*pd2*pow(p3,3) + 4*pd2*p3 + 2*pd1))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd2_d*(- (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*p3*pd3*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*pdd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*pd1_d*(2*pd2*pow(p1,3)*p3 + 2*pd1*pow(p1,3) - 2*pd1*pow(p1,2)*p2*p3 + 2*pd2*p1*pow(p2,2)*p3 + 2*pd1*p1*pow(p2,2) + 2*pd2*p1*pow(p3,3) + 2*pd1*p1*pow(p3,2) + 2*pd2*p1*p3 + 2*pd1*p1 - 2*pd1*pow(p2,3)*p3 - 2*pd1*p2*pow(p3,3) - 2*pd1*p2*p3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), ((4*pd2_d*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2) + (2*pd1_d*(2*pd3*pow(p1,3) - 2*pd1*pow(p1,2)*p3 + 2*pd2*pow(p1,2) - 2*pd3*p1*pow(p2,2) + 4*pd2*p1*p2*p3 + 2*pd3*p1*pow(p3,2) + 2*pd3*p1 - 2*pd1*pow(p2,2)*p3 - 2*pd2*pow(p2,2) - 4*pd3*p2*p3 - 2*pd1*pow(p3,3) + 2*pd2*pow(p3,2) - 2*pd1*p3 + 2*pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)) - (4*p2*pd3_d*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*(pd3*pow(p1,3) - pd1*pow(p1,2)*p3 + pd2*pow(p1,2) - pd3*p1*pow(p2,2) + 2*pd2*p1*p2*p3 + pd3*p1*pow(p3,2) + pd3*p1 - pd1*pow(p2,2)*p3 - pd2*pow(p2,2) - 2*pd3*p2*p3 - pd1*pow(p3,3) + pd2*pow(p3,2) - pd1*p3 + pd2))/pow((pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1),2)), (- pd3_d*((2*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1)*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + pd2_d*((2*((2*(pd3 - p1*pd2 + p2*pd1))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*p3*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p2*pd2*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p1*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*p3*pd3*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)) + (2*pdd2_d*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p3*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*pdd3_d*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) + (2*pd1_d*(- pd3*pow(p1,4) + 2*pd1*pow(p1,3)*p3 - 2*pd2*pow(p1,3) + 2*pd1*pow(p1,2)*p2 + 2*pd1*p1*pow(p2,2)*p3 - 2*pd2*p1*pow(p2,2) + 2*pd1*p1*pow(p3,3) - 2*pd2*p1*pow(p3,2) + 2*pd1*p1*p3 - 2*pd2*p1 + pd3*pow(p2,4) + 2*pd1*pow(p2,3) + 2*pd3*pow(p2,2)*pow(p3,2) + 2*pd3*pow(p2,2) + 2*pd1*p2*pow(p3,2) + 2*pd1*p2 + pd3*pow(p3,4) + 2*pd3*pow(p3,2) + pd3))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1))), (- pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,3) - p1*pow(p2,2) + p1*pow(p3,2) + p1 - 2*p2*p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) - pow(p2,2) + pow(p3,2) - 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) + (2*pdd3_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*p2*pd2)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2) + 2*p1*p2*p3 - pow(p2,2) + pow(p3,2) + 1))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p3*pd3)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1)))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p1*p2*pd1)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1))*(pow(p1,2)*p3 - 2*p1*p2 - pow(p2,2)*p3 + pow(p3,3) + p3))/(pow(p1,4) + 2*pow(p1,2)*pow(p3,2) + 2*pow(p1,2) - pow(p2,4) + pow(p3,4) + 2*pow(p3,2) + 1)) - (2*p1*pdd2_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) + (2*p2*pdd1_d)/(pow(p1,2) - pow(p2,2) + pow(p3,2) + 1) - (2*pd1_d*(- pd2*pow(p1,4) + 2*pd1*pow(p1,3)*p2 + 2*pd3*pow(p1,2)*p2*p3 - 2*pd2*pow(p1,2)*pow(p3,2) - 2*pd2*pow(p1,2) + 2*pd1*p1*pow(p2,3) + 2*pd1*p1*p2*pow(p3,2) + 2*pd1*p1*p2 + pd2*pow(p2,4) + 2*pd3*pow(p2,3)*p3 + 2*pd3*p2*pow(p3,3) + 2*pd3*p2*p3 - pd2*pow(p3,4) - 2*pd2*pow(p3,2) - pd2))/(pow((pow(p1,2) - pow(p2,2) + pow(p3,2) + 1),2)*(pow(p1,2) + pow(p2,2) + pow(p3,2) + 1)));
    //ROS_INFO("did use Ybody");
    return Yout;
};


int main(int argc, char *argv[]){
	std::stringstream ss;
	ss << "controller" << argv[1];
	ros::init(argc,argv,ss.str());
	ros::NodeHandle n;
	ros::Duration(15).sleep(); 
	Controller ctrl (atoi(argv[1]),n);
	ROS_INFO("all good!");
	ros::Subscriber stateSub = n.subscribe("/gazebo/link_states",1, &Controller::stateCallback, &ctrl);
	ros::spin();
	return 0;
}