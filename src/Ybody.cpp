#include "Ybody.h"
#include <math.h>
#include "ros/ros.h"
#include "geometry_msgs/Vector3.h"
#include "orbit_sim/refSig6.h"
#include <stdlib.h>
#include <sstream>
#include "gazebo_msgs/LinkStates.h"
#include "geometry_msgs/Wrench.h"
#include "geometry_msgs/Pose.h"
#include "geometry_msgs/Twist.h"
#include "orbit_sim/state.h"

MatrixXd Ybody(Vector6d q, Vector6d qd, Vector6d qd_d, Vector6d qdd_d){
    Yout = MatrixXd(6,40);
    double qx = q[0], qy = q[1], qz = q[2], p1 = q[3], p2 = q[4], p3 = q[5];
    double qdx = qd[0], qdy = qd[1], qdz = qd[2], pd1 = qd[3], pd2 = qd[4], pd3 = qd[5];
    double qdx_d = qd_d[0], qdy_d = qd_d[1], qdz_d = qd_d[2], pd1_d = qd_d[3], pd2_d = qd_d[4], pd3_d = qd_d[5];
    double qddx_d = qdd_d[0], qddy_d = qdd_d[1], qddz_d = qdd_d[2], pdd1_d = qdd_d[3], pdd2_d = qdd_d[4], pdd3_d = qdd_d[5];
    Yout << 0, ((2*pdd3_d)/(p1^2 - p2^2 + p3^2 + 1) - pd3_d*((2*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd1_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) - (2*p3*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) - pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1)), (pd1_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) - (2*p3*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) + pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + pd3_d*((2*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)), qddx_d, (pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 + (4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*p1*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2) + pd1_d*((4*p2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 - (4*p3*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))), ((4*p3*pd1_d*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*pd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*pd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2), ((4*p1*pd2_d*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*pd3_d*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*p2*pd1_d*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), ArrayXd::Zero(33),
            (pd3_d*((2*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd3_d)/(p1^2 - p2^2 + p3^2 + 1) + pd1_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) - (2*p3*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) + pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*((2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1)), 0, ((2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - pd1_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) - (2*p3*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) - pd2_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*pdd3_d*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)), qddy_d, ((4*p2*pd3_d*(p1^2 - p2^2 + p3^2 - 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*pd1_d*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*pd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2), (pd1_d*((4*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*p2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2) - pd2_d*((4*p1*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 - (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 - (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2)), ((4*p1*pd2_d*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*pd3_d*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*p2*pd1_d*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), ArrayXd::Zero(33),
            ((2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd3_d*((2*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd1_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) - (2*p3*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) - (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)), (pd1_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) - (2*p3*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) - (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + pd2_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd3_d*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)), 0, qddz_d, ((4*p2*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2 - p2^2 + p3^2 - 1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*pd1_d*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2), ((4*p3*pd1_d*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 - (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), (pd1_d*((4*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*p3*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))) + pd3_d*((4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2)), ArrayXd::Zero(33),
            0, (-qddz_d), qddy_d, 0, 0, 0, 0, (- pd3_d*((4*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*(pd3 - p1*pd2 + p2*pd1)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))) + pd2_d*((4*(pd3 - p1*pd2 + p2*pd1)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*p1*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))) - (2*pd1_d*(2*pd3*p1^3*p2 - 2*pd2*p1^3*p3 + 2*pd2*p1^2*p2 + 2*pd3*p1^2*p3 - 2*pd3*p1*p2^3 + 2*pd2*p1*p2^2*p3 + 2*pd3*p1*p2*p3^2 + 2*pd3*p1*p2 - 2*pd2*p1*p3^3 - 2*pd2*p1*p3 - 2*pd2*p2^3 - 2*pd3*p2^2*p3 + 2*pd2*p2*p3^2 + 2*pd2*p2 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd2_d*(- (2*p1*((2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + pd3_d*((2*((2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(pd3*p1^4 - 2*pd1*p1^3*p3 - 2*pd3*p1^2*p2^2 + 2*pd2*p1^2*p2*p3 + 2*pd1*p1^2*p2 + 2*pd3*p1^2 - 2*pd1*p1*p2^2*p3 - 4*pd2*p1*p2^2 - 2*pd1*p1*p3^3 - 2*pd1*p1*p3 + pd3*p2^4 - 2*pd2*p2^3*p3 + 2*pd1*p2^3 - 4*pd3*p2^2*p3^2 + 2*pd3*p2^2 + 2*pd2*p2*p3^3 + 2*pd1*p2*p3^2 + 2*pd2*p2*p3 + 2*pd1*p2 - pd3*p3^4 + pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- (2*pdd3_d)/(p1^2 - p2^2 + p3^2 + 1) + pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pd1_d*(- pd2*p1^4 + 2*pd1*p1^3*p2 + 2*pd1*p1^2*p3 - 2*pd2*p1^2 + 2*pd1*p1*p2^3 + 2*pd1*p1*p2*p3^2 - 4*pd2*p1*p2*p3 + 2*pd1*p1*p2 + pd2*p2^4 + 4*pd3*p2^3*p3 - 2*pd2*p2^2*p3^2 + 2*pd1*p2^2*p3 + 4*pd3*p2*p3 + pd2*p3^4 + 2*pd1*p3^3 + 2*pd1*p3 - pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, (pd2_d*(- (2*p1*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + pd3_d*((2*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(- pd3*p1^4 + 2*pd1*p1^3*p3 - 2*pd3*p1^2 + 2*pd1*p1*p2^2*p3 + 2*pd1*p1*p3^3 + 2*pd1*p1*p3 + pd3*p2^4 + 2*pd3*p2^2*p3^2 + pd3*p3^4 - pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + pd2_d*(- (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd3_d*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pd1_d*(- pd2*p1^4 + 2*pd1*p1^3*p2 + 2*pd3*p1^2*p2*p3 - 2*pd2*p1^2*p3^2 - 2*pd2*p1^2 + 2*pd1*p1*p2^3 + 2*pd1*p1*p2*p3^2 + 2*pd1*p1*p2 + pd2*p2^4 + 2*pd3*p2^3*p3 + 2*pd3*p2*p3^3 + 2*pd3*p2*p3 - pd2*p3^4 - 2*pd2*p3^2 - pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd3_d*(- (2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) - (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + pd2_d*((2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) - (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*pdd3_d*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(- 2*pd2*p1^3*p3 + 2*pd1*p1^3 + 2*pd1*p1^2*p2*p3 + 4*pd3*p1^2*p3 - 2*pd2*p1*p2^2*p3 + 2*pd1*p1*p2^2 - 2*pd2*p1*p3^3 + 2*pd1*p1*p3^2 - 2*pd2*p1*p3 + 2*pd1*p1 + 2*pd1*p2^3*p3 + 4*pd3*p2^2*p3 + 2*pd1*p2*p3^3 + 2*pd1*p2*p3 + 4*pd3*p3^3 + 4*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 - (4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (4*p1*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2) + (2*pd1_d*(- 2*pd2*p1^3*p2 + 2*pd3*p1^3*p3 + 2*pd1*p1^2*p2^2 + 2*pd3*p1^2*p2 - 2*pd1*p1^2*p3^2 + 2*pd2*p1^2*p3 - 2*pd2*p1*p2^3 - 2*pd3*p1*p2^2*p3 + 2*pd2*p1*p2*p3^2 - 2*pd2*p1*p2 + 2*pd3*p1*p3^3 + 2*pd3*p1*p3 + 2*pd1*p2^4 + 2*pd3*p2^3 - 2*pd2*p2^2*p3 + 2*pd1*p2^2 - 2*pd3*p2*p3^2 + 2*pd3*p2 - 2*pd1*p3^4 + 2*pd2*p3^3 - 2*pd1*p3^2 + 2*pd2*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, (- pd3_d*((2*((pd2 + p1*pd3 + p3*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - pd2_d*(- (2*p1*((pd2 + p1*pd3 + p3*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd3_d*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(2*pd1*p1^3 + 2*pd3*p1^2*p3 + 2*pd1*p1*p2^2 + 2*pd1*p1*p3^2 + 2*pd1*p1 + 2*pd3*p2^2*p3 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, (- pd2_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*pdd3_d*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(2*pd3*p1^3*p2 + 2*pd1*p1^3 - 2*pd1*p1^2*p2*p3 + 2*pd2*p1^2*p2 + 2*pd3*p1^2*p3 - 2*pd3*p1*p2^3 + 4*pd2*p1*p2^2*p3 + 2*pd1*p1*p2^2 + 2*pd3*p1*p2*p3^2 + 2*pd3*p1*p2 + 2*pd1*p1*p3^2 + 2*pd1*p1 - 2*pd1*p2^3*p3 - 2*pd2*p2^3 - 2*pd3*p2^2*p3 - 2*pd1*p2*p3^3 + 2*pd2*p2*p3^2 - 2*pd1*p2*p3 + 2*pd2*p2 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, 0, (- pd3_d*((2*((pd2 + p1*pd3 + p3*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - pd2_d*(- (2*p1*((pd2 + p1*pd3 + p3*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd3_d*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(2*pd1*p1^3 + 2*pd3*p1^2*p3 + 2*pd1*p1*p2^2 + 2*pd1*p1*p3^2 + 2*pd1*p1 + 2*pd3*p2^2*p3 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, (-qddz_d), qddy_d, 0, ((2*pd1_d*(- 2*pd2*p1^3 + 2*pd1*p1^2*p2 + 2*pd3*p1^2 - 2*pd2*p1*p2^2 - 2*pd2*p1*p3^2 - 2*pd2*p1 + 2*pd1*p2^3 + 2*pd3*p2^2 + 2*pd1*p2*p3^2 + 2*pd1*p2 + 2*pd3*p3^2 + 2*pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) + (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*p2*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2 - p2^2 + p3^2 - 1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), (- (4*pd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (2*pd1_d*(2*pd3*p1^3 - 2*pd1*p1^2*p3 + 2*pd2*p1^2 - 2*pd3*p1*p2^2 + 4*pd2*p1*p2*p3 + 2*pd3*p1*p3^2 + 2*pd3*p1 - 2*pd1*p2^2*p3 - 2*pd2*p2^2 - 4*pd3*p2*p3 - 2*pd1*p3^3 + 2*pd2*p3^2 - 2*pd1*p3 + 2*pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) + (4*p2*pd3_d*(p1^2 - p2^2 + p3^2 - 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2), 0, (- (2*pd1_d*(- 2*pd2*p1^3*p3 + 2*pd1*p1^2*p2*p3 + 2*pd3*p1^2*p3 - 2*pd2*p1*p2^2*p3 - 2*pd2*p1*p3^3 - 2*pd2*p1*p3 + 2*pd1*p2^3*p3 + 2*pd3*p2^2*p3 + 2*pd1*p2*p3^3 + 2*pd1*p2*p3 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) + (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), (- pd2_d*((4*p1*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 - (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 - (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + (2*pd1_d*(- 2*pd2*p1^3*p2 + 2*pd1*p1^2*p2^2 + 2*pd2*p1^2*p3 + 2*pd1*p1^2 - 2*pd2*p1*p2^3 - 2*pd2*p1*p2*p3^2 - 6*pd2*p1*p2 + 2*pd1*p2^4 + 4*pd3*p2^3 + 2*pd1*p2^2*p3^2 - 2*pd2*p2^2*p3 + 4*pd1*p2^2 + 4*pd3*p2 + 2*pd2*p3^3 + 2*pd1*p3^2 + 2*pd2*p3 + 2*pd1))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, (- pd3_d*((4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - (2*pd1_d*(- 2*pd3*p1^3*p3 - 2*pd3*p1^2*p2 + 2*pd1*p1^2*p3^2 + 2*pd1*p1^2 + 2*pd3*p1*p2^2*p3 - 4*pd2*p1*p2*p3^2 - 4*pd2*p1*p2 - 2*pd3*p1*p3^3 - 2*pd3*p1*p3 + 2*pd3*p2^3 + 2*pd1*p2^2*p3^2 + 2*pd1*p2^2 + 2*pd3*p2*p3^2 + 2*pd3*p2 + 2*pd1*p3^4 + 4*pd1*p3^2 + 2*pd1))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- (2*pd1_d*(2*pd3*p1^3*p2 - 2*pd1*p1^2*p2*p3 + 2*pd2*p1^2*p2 - 2*pd3*p1*p2^3 + 4*pd2*p1*p2^2*p3 + 2*pd3*p1*p2*p3^2 + 2*pd3*p1*p2 - 2*pd1*p2^3*p3 - 2*pd2*p2^3 - 4*pd3*p2^2*p3 - 2*pd1*p2*p3^3 + 2*pd2*p2*p3^2 - 2*pd1*p2*p3 + 2*pd2*p2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) - (4*pd3_d*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*p1*pd2_d*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), ((2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - pd2_d*(- (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*pdd3_d*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(2*pd1*p1^3 + 2*pd3*p1^2*p3 + 2*pd1*p1*p2^2 + 2*pd1*p1*p3^2 + 2*pd1*p1 + 2*pd3*p2^2*p3 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- pd2_d*(- (2*p1*((2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd3_d*((2*((2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(pd3*p1^4 - 2*pd1*p1^3*p3 - 2*pd3*p1^2*p2^2 + 2*pd2*p1^2*p2*p3 + 2*pd1*p1^2*p2 + 2*pd3*p1^2 - 2*pd1*p1*p2^2*p3 - 4*pd2*p1*p2^2 - 2*pd1*p1*p3^3 - 2*pd1*p1*p3 + pd3*p2^4 - 2*pd2*p2^3*p3 + 2*pd1*p2^3 - 4*pd3*p2^2*p3^2 + 2*pd3*p2^2 + 2*pd2*p2*p3^3 + 2*pd1*p2*p3^2 + 2*pd2*p2*p3 + 2*pd1*p2 - pd3*p3^4 + pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), ((2*pdd3_d)/(p1^2 - p2^2 + p3^2 + 1) - pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pd1_d*(- pd2*p1^4 + 2*pd1*p1^3*p2 + 2*pd1*p1^2*p3 - 2*pd2*p1^2 + 2*pd1*p1*p2^3 + 2*pd1*p1*p2*p3^2 - 4*pd2*p1*p2*p3 + 2*pd1*p1*p2 + pd2*p2^4 + 4*pd3*p2^3*p3 - 2*pd2*p2^2*p3^2 + 2*pd1*p2^2*p3 + 4*pd3*p2*p3 + pd2*p3^4 + 2*pd1*p3^3 + 2*pd1*p3 - pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- (2*pd1_d*(2*pd3*p1^3*p2 - 2*pd1*p1^2*p2*p3 + 2*pd2*p1^2*p2 - 2*pd3*p1*p2^3 + 4*pd2*p1*p2^2*p3 + 2*pd3*p1*p2*p3^2 + 2*pd3*p1*p2 - 2*pd1*p2^3*p3 - 2*pd2*p2^3 - 4*pd3*p2^2*p3 - 2*pd1*p2*p3^3 + 2*pd2*p2*p3^2 - 2*pd1*p2*p3 + 2*pd2*p2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) - (4*pd3_d*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*p1*pd2_d*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), (- pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 - (4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (4*p1*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2) - (2*pd1_d*(- 2*pd2*p1^3*p2 + 2*pd3*p1^3*p3 + 2*pd1*p1^2*p2^2 + 2*pd3*p1^2*p2 - 2*pd1*p1^2*p3^2 + 2*pd2*p1^2*p3 - 2*pd2*p1*p2^3 - 2*pd3*p1*p2^2*p3 + 2*pd2*p1*p2*p3^2 - 2*pd2*p1*p2 + 2*pd3*p1*p3^3 + 2*pd3*p1*p3 + 2*pd1*p2^4 + 2*pd3*p2^3 - 2*pd2*p2^2*p3 + 2*pd1*p2^2 - 2*pd3*p2*p3^2 + 2*pd3*p2 - 2*pd1*p3^4 + 2*pd2*p3^3 - 2*pd1*p3^2 + 2*pd2*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- (2*pd1_d*(- 2*pd2*p1^3*p3 + 2*pd1*p1^2*p2*p3 + 2*pd3*p1^2*p3 - 2*pd2*p1*p2^2*p3 - 2*pd2*p1*p3^3 - 2*pd2*p1*p3 + 2*pd1*p2^3*p3 + 2*pd3*p2^2*p3 + 2*pd1*p2*p3^3 + 2*pd1*p2*p3 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) + (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)));
            qddz_d, 0, (-qddx_d), 0, 0, 0, 0, (- pd3_d*((2*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(p1^2 - p2^2 + p3^2 - 1)*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd2_d*((2*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) + (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(- pd3*p1^4 + 2*pd1*p1^3*p3 + 2*pd2*p1^3 - 2*pd1*p1^2*p2 - 4*pd3*p1^2 + 2*pd1*p1*p2^2*p3 + 2*pd2*p1*p2^2 + 2*pd1*p1*p3^3 + 2*pd2*p1*p3^2 + 2*pd1*p1*p3 + 2*pd2*p1 + pd3*p2^4 - 2*pd1*p2^3 + 2*pd3*p2^2*p3^2 - 2*pd3*p2^2 - 2*pd1*p2*p3^2 - 2*pd1*p2 + pd3*p3^4 - 2*pd3*p3^2 - 3*pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd2_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pdd3_d*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(- 2*pd3*p1^3*p2 + 2*pd1*p1^3 + 2*pd1*p1^2*p2*p3 - 2*pd2*p1^2*p2 + 2*pd3*p1^2*p3 + 2*pd3*p1*p2^3 - 4*pd2*p1*p2^2*p3 + 2*pd1*p1*p2^2 - 2*pd3*p1*p2*p3^2 - 2*pd3*p1*p2 + 2*pd1*p1*p3^2 + 2*pd1*p1 + 2*pd1*p2^3*p3 + 2*pd2*p2^3 + 6*pd3*p2^2*p3 + 2*pd1*p2*p3^3 - 2*pd2*p2*p3^2 + 2*pd1*p2*p3 - 2*pd2*p2 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd2_d*((4*p1*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 + (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 + (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + (2*pd1_d*(2*pd2*p1^3*p2 - 2*pd1*p1^2*p2^2 - 4*pd3*p1^2*p2 + 2*pd2*p1^2*p3 + 2*pd1*p1^2 + 2*pd2*p1*p2^3 + 2*pd2*p1*p2*p3^2 - 2*pd2*p1*p2 - 2*pd1*p2^4 - 2*pd1*p2^2*p3^2 - 2*pd2*p2^2*p3 - 4*pd3*p2*p3^2 + 2*pd2*p3^3 + 2*pd1*p3^2 + 2*pd2*p3 + 2*pd1))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- pd2_d*(- (2*p1*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd3_d*((2*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(- pd3*p1^4 + 2*pd1*p1^3*p3 - 2*pd3*p1^2 + 2*pd1*p1*p2^2*p3 + 2*pd1*p1*p3^3 + 2*pd1*p1*p3 + pd3*p2^4 + 2*pd3*p2^2*p3^2 + pd3*p3^4 - pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, 0, (- pd2_d*((4*(pd3 - p1*pd2 + p2*pd1)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*p1*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))) + pd3_d*((4*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*p2*(pd3 - p1*pd2 + p2*pd1)*(p1^2 - p2^2 + p3^2 - 1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))) - (2*pd1_d*(- 2*pd2*p1^3 + 2*pd3*p1^2*p2^2 - 2*pd2*p1^2*p2*p3 + 2*pd3*p1^2 + 2*pd2*p1*p2^2 - 2*pd2*p1*p3^2 - 2*pd2*p1 - 2*pd3*p2^4 + 2*pd2*p2^3*p3 + 2*pd3*p2^2*p3^2 - 2*pd2*p2*p3^3 - 2*pd2*p2*p3 + 2*pd3*p3^2 + 2*pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- (2*pdd3_d)/(p1^2 - p2^2 + p3^2 + 1) + pd2_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) + pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pd1_d*(- pd2*p1^4 + 2*pd1*p1^3*p2 + 2*pd3*p1^3 + 2*pd3*p1^2*p2*p3 - 2*pd2*p1^2*p3^2 - 2*pd1*p1^2*p3 + 2*pd1*p1*p2^3 - 2*pd3*p1*p2^2 + 2*pd1*p1*p2*p3^2 + 4*pd2*p1*p2*p3 + 2*pd1*p1*p2 + 2*pd3*p1*p3^2 + 2*pd3*p1 + pd2*p2^4 + 2*pd3*p2^3*p3 - 2*pd1*p2^2*p3 - 2*pd2*p2^2 + 2*pd3*p2*p3^3 - 2*pd3*p2*p3 - pd2*p3^4 - 2*pd1*p3^3 - 2*pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd3_d*((2*((pd2 + p1*pd3 + p3*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + pd2_d*(- (2*p1*((pd2 + p1*pd3 + p3*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd3_d*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(2*pd1*p1^3 + 2*pd3*p1^2*p3 + 2*pd1*p1*p2^2 + 2*pd1*p1*p3^2 + 2*pd1*p1 + 2*pd3*p2^2*p3 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, (pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + pd2_d*(- (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd3_d*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pd1_d*(- pd2*p1^4 + 2*pd1*p1^3*p2 + 2*pd3*p1^2*p2*p3 - 2*pd2*p1^2*p3^2 - 2*pd2*p1^2 + 2*pd1*p1*p2^3 + 2*pd1*p1*p2*p3^2 + 2*pd1*p1*p2 + pd2*p2^4 + 2*pd3*p2^3*p3 + 2*pd3*p2*p3^3 + 2*pd3*p2*p3 - pd2*p3^4 - 2*pd2*p3^2 - pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- pd2_d*((2*p1*((2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + pd3_d*((2*((2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) - (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(- pd3*p1^4 + 2*pd1*p1^3*p3 - 2*pd3*p1^2*p2^2 + 2*pd2*p1^2*p2*p3 + 2*pd1*p1^2*p2 - 2*pd3*p1^2 + 2*pd1*p1*p2^2*p3 - 4*pd2*p1*p2^2 + 2*pd1*p1*p3^3 + 2*pd1*p1*p3 + 3*pd3*p2^4 - 2*pd2*p2^3*p3 + 2*pd1*p2^3 + 2*pd3*p2^2 + 2*pd2*p2*p3^3 + 2*pd1*p2*p3^2 + 2*pd2*p2*p3 + 2*pd1*p2 + pd3*p3^4 - pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, 0, (- pd2_d*(- (2*p1*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd3_d*((2*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(- pd3*p1^4 + 2*pd1*p1^3*p3 - 2*pd3*p1^2 + 2*pd1*p1*p2^2*p3 + 2*pd1*p1*p3^3 + 2*pd1*p1*p3 + pd3*p2^4 + 2*pd3*p2^2*p3^2 + pd3*p3^4 - pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), qddz_d, 0, (-qddx_d), (- (2*pd1_d*(- 2*pd2*p1^3 + 2*pd1*p1^2*p2 + 2*pd3*p1^2 - 2*pd2*p1*p2^2 - 2*pd2*p1*p3^2 - 2*pd2*p1 + 2*pd1*p2^3 + 2*pd3*p2^2 + 2*pd1*p2*p3^2 + 2*pd1*p2 + 2*pd3*p3^2 + 2*pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) - (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*p2*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2 - p2^2 + p3^2 - 1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), 0, (- pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 + (4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*p1*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2) - (2*pd1_d*(- 2*pd2*p1^3*p2 - 2*pd3*p1^3*p3 + 2*pd1*p1^2*p2^2 + 2*pd3*p1^2*p2 + 2*pd1*p1^2*p3^2 - 2*pd2*p1^2*p3 - 2*pd2*p1*p2^3 + 2*pd3*p1*p2^2*p3 - 6*pd2*p1*p2*p3^2 - 2*pd2*p1*p2 - 2*pd3*p1*p3^3 - 2*pd3*p1*p3 + 2*pd1*p2^4 + 2*pd3*p2^3 + 4*pd1*p2^2*p3^2 + 2*pd2*p2^2*p3 + 2*pd1*p2^2 + 6*pd3*p2*p3^2 + 2*pd3*p2 + 2*pd1*p3^4 - 2*pd2*p3^3 + 2*pd1*p3^2 - 2*pd2*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), ((2*pd1_d*(- 2*pd2*p1^3*p3 + 2*pd1*p1^2*p2*p3 + 2*pd3*p1^2*p3 - 2*pd2*p1*p2^2*p3 - 2*pd2*p1*p3^3 - 2*pd2*p1*p3 + 2*pd1*p2^3*p3 + 2*pd3*p2^2*p3 + 2*pd1*p2*p3^3 + 2*pd1*p2*p3 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) - (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), 0, ((4*pd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (2*pd1_d*(- 2*pd3*p1^2*p2*p3 + 2*pd2*p1^2*p3^2 + 2*pd1*p1^2*p3 - 4*pd2*p1*p2*p3 + 2*pd3*p2^3*p3 - 2*pd2*p2^2*p3^2 + 2*pd1*p2^2*p3 - 2*pd3*p2*p3^3 + 2*pd3*p2*p3 + 2*pd2*p3^4 + 2*pd1*p3^3 + 2*pd2*p3^2 + 2*pd1*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) + (4*pd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2), (pd3_d*((4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + (2*pd1_d*(- 2*pd3*p1^3*p3 - 2*pd3*p1^2*p2 + 2*pd1*p1^2*p3^2 + 2*pd1*p1^2 + 2*pd3*p1*p2^2*p3 - 4*pd2*p1*p2*p3^2 - 4*pd2*p1*p2 - 2*pd3*p1*p3^3 - 2*pd3*p1*p3 + 2*pd3*p2^3 + 2*pd1*p2^2*p3^2 + 2*pd1*p2^2 + 2*pd3*p2*p3^2 + 2*pd3*p2 + 2*pd1*p3^4 + 4*pd1*p3^2 + 2*pd1))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, ((2*pd1_d*(- 2*pd3*p1^2*p2^2 + 2*pd2*p1^2*p2*p3 + 2*pd1*p1^2*p2 - 4*pd2*p1*p2^2 + 2*pd3*p2^4 - 2*pd2*p2^3*p3 + 2*pd1*p2^3 - 2*pd3*p2^2*p3^2 + 2*pd3*p2^2 + 2*pd2*p2*p3^3 + 2*pd1*p2*p3^2 + 2*pd2*p2*p3 + 2*pd1*p2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) + (4*pd3_d*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*p1*pd2_d*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), ((2*pd1_d*(- 2*pd3*p1^2*p2^2 + 2*pd2*p1^2*p2*p3 + 2*pd1*p1^2*p2 - 4*pd2*p1*p2^2 + 2*pd3*p2^4 - 2*pd2*p2^3*p3 + 2*pd1*p2^3 - 2*pd3*p2^2*p3^2 + 2*pd3*p2^2 + 2*pd2*p2*p3^3 + 2*pd1*p2*p3^2 + 2*pd2*p2*p3 + 2*pd1*p2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) + (4*pd3_d*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*p1*pd2_d*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), (- pd2_d*((2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*pdd3_d*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(- 2*pd3*p1^3*p2 + 2*pd1*p1^3 + 2*pd1*p1^2*p2*p3 - 2*pd2*p1^2*p2 + 2*pd3*p1^2*p3 + 2*pd3*p1*p2^3 - 4*pd2*p1*p2^2*p3 + 2*pd1*p1*p2^2 - 2*pd3*p1*p2*p3^2 - 2*pd3*p1*p2 + 2*pd1*p1*p3^2 + 2*pd1*p1 + 2*pd1*p2^3*p3 + 2*pd2*p2^3 + 6*pd3*p2^2*p3 + 2*pd1*p2*p3^3 - 2*pd2*p2*p3^2 + 2*pd1*p2*p3 - 2*pd2*p2 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- pd2_d*((4*p1*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 + (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 + (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - (2*pd1_d*(2*pd2*p1^3*p2 - 2*pd1*p1^2*p2^2 - 4*pd3*p1^2*p2 + 2*pd2*p1^2*p3 + 2*pd1*p1^2 + 2*pd2*p1*p2^3 + 2*pd2*p1*p2*p3^2 - 2*pd2*p1*p2 - 2*pd1*p2^4 - 2*pd1*p2^2*p3^2 - 2*pd2*p2^2*p3 - 4*pd3*p2*p3^2 + 2*pd2*p3^3 + 2*pd1*p3^2 + 2*pd2*p3 + 2*pd1))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- pd2_d*((2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd3_d*((2*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(- pd3*p1^4 + 2*pd1*p1^3*p3 - 2*pd3*p1^2 + 2*pd1*p1*p2^2*p3 + 2*pd1*p1*p3^3 + 2*pd1*p1*p3 + pd3*p2^4 + 2*pd3*p2^2*p3^2 + pd3*p3^4 - pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), ((2*pdd3_d)/(p1^2 - p2^2 + p3^2 + 1) - pd2_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) - pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pd1_d*(- pd2*p1^4 + 2*pd1*p1^3*p2 + 2*pd3*p1^3 + 2*pd3*p1^2*p2*p3 - 2*pd2*p1^2*p3^2 - 2*pd1*p1^2*p3 + 2*pd1*p1*p2^3 - 2*pd3*p1*p2^2 + 2*pd1*p1*p2*p3^2 + 4*pd2*p1*p2*p3 + 2*pd1*p1*p2 + 2*pd3*p1*p3^2 + 2*pd3*p1 + pd2*p2^4 + 2*pd3*p2^3*p3 - 2*pd1*p2^2*p3 - 2*pd2*p2^2 + 2*pd3*p2*p3^3 - 2*pd3*p2*p3 - pd2*p3^4 - 2*pd1*p3^3 - 2*pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- (2*pd1_d*(- 2*pd2*p1^3 + 2*pd1*p1^2*p2 + 2*pd3*p1^2 - 2*pd2*p1*p2^2 - 2*pd2*p1*p3^2 - 2*pd2*p1 + 2*pd1*p2^3 + 2*pd3*p2^2 + 2*pd1*p2*p3^2 + 2*pd1*p2 + 2*pd3*p3^2 + 2*pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) - (4*pd2_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*p2*pd3_d*(pd3 - p1*pd2 + p2*pd1)*(p1^2 - p2^2 + p3^2 - 1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)));
            (-qddy_d), qddx_d, 0, 0, 0, 0, 0, ((2*pdd3_d)/(p1^2 - p2^2 + p3^2 + 1) - pd2_d*((2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) - pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pd1_d*(- pd2*p1^4 + 2*pd1*p1^3*p2 - 2*pd3*p1^3 + 2*pd3*p1^2*p2*p3 - 2*pd2*p1^2*p3^2 + 2*pd1*p1^2*p3 - 4*pd2*p1^2 + 2*pd1*p1*p2^3 + 2*pd3*p1*p2^2 + 2*pd1*p1*p2*p3^2 - 4*pd2*p1*p2*p3 + 2*pd1*p1*p2 - 2*pd3*p1*p3^2 - 2*pd3*p1 + pd2*p2^4 + 2*pd3*p2^3*p3 + 2*pd1*p2^2*p3 + 2*pd2*p2^2 + 2*pd3*p2*p3^3 + 6*pd3*p2*p3 - pd2*p3^4 + 2*pd1*p3^3 - 4*pd2*p3^2 + 2*pd1*p3 - 3*pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd3_d*((4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - (2*pd1_d*(2*pd3*p1^3*p3 - 2*pd3*p1^2*p2 - 2*pd1*p1^2*p3^2 + 4*pd2*p1^2*p3 + 2*pd1*p1^2 - 2*pd3*p1*p2^2*p3 + 4*pd2*p1*p2*p3^2 - 4*pd2*p1*p2 + 2*pd3*p1*p3^3 + 2*pd3*p1*p3 + 2*pd3*p2^3 - 2*pd1*p2^2*p3^2 - 4*pd2*p2^2*p3 + 2*pd1*p2^2 - 6*pd3*p2*p3^2 + 2*pd3*p2 - 2*pd1*p3^4 + 4*pd2*p3^3 + 4*pd2*p3 + 2*pd1))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + pd2_d*(- (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pdd3_d*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(2*pd2*p1^3*p3 + 2*pd1*p1^3 - 2*pd1*p1^2*p2*p3 + 2*pd2*p1*p2^2*p3 + 2*pd1*p1*p2^2 + 2*pd2*p1*p3^3 + 2*pd1*p1*p3^2 + 2*pd2*p1*p3 + 2*pd1*p1 - 2*pd1*p2^3*p3 - 2*pd1*p2*p3^3 - 2*pd1*p2*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd2_d*(- (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd3_d*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pd1_d*(- pd2*p1^4 + 2*pd1*p1^3*p2 + 2*pd3*p1^2*p2*p3 - 2*pd2*p1^2*p3^2 - 2*pd2*p1^2 + 2*pd1*p1*p2^3 + 2*pd1*p1*p2*p3^2 + 2*pd1*p1*p2 + pd2*p2^4 + 2*pd3*p2^3*p3 + 2*pd3*p2*p3^3 + 2*pd3*p2*p3 - pd2*p3^4 - 2*pd2*p3^2 - pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, 0, ((2*pdd3_d)/(p1^2 - p2^2 + p3^2 + 1) - pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pd1_d*(pd2*p1^4 - 2*pd1*p1^3*p2 - 4*pd3*p1^2*p2*p3 + 4*pd2*p1^2*p3^2 + 2*pd1*p1^2*p3 + 2*pd2*p1^2 - 2*pd1*p1*p2^3 - 2*pd1*p1*p2*p3^2 - 4*pd2*p1*p2*p3 - 2*pd1*p1*p2 - pd2*p2^4 - 2*pd2*p2^2*p3^2 + 2*pd1*p2^2*p3 - 4*pd3*p2*p3^3 + 3*pd2*p3^4 + 2*pd1*p3^3 + 4*pd2*p3^2 + 2*pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd3_d*((2*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*(p1^2 - p2^2 + p3^2 - 1)*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) - (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd2_d*((2*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) - (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) - (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(- pd3*p1^4 + 2*pd1*p1^3*p3 - 2*pd2*p1^3 + 2*pd1*p1^2*p2 + 2*pd1*p1*p2^2*p3 - 2*pd2*p1*p2^2 + 2*pd1*p1*p3^3 - 2*pd2*p1*p3^2 + 2*pd1*p1*p3 - 2*pd2*p1 + pd3*p2^4 + 2*pd1*p2^3 + 2*pd3*p2^2*p3^2 + 2*pd3*p2^2 + 2*pd1*p2*p3^2 + 2*pd1*p2 + pd3*p3^4 + 2*pd3*p3^2 + pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, (- pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - pd2_d*(- (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (p2*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(- (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd3_d*(p1^2 + p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pd1_d*(- pd2*p1^4 + 2*pd1*p1^3*p2 + 2*pd3*p1^2*p2*p3 - 2*pd2*p1^2*p3^2 - 2*pd2*p1^2 + 2*pd1*p1*p2^3 + 2*pd1*p1*p2*p3^2 + 2*pd1*p1*p2 + pd2*p2^4 + 2*pd3*p2^3*p3 + 2*pd3*p2*p3^3 + 2*pd3*p2*p3 - pd2*p3^4 - 2*pd2*p3^2 - pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, (- pd3_d*((4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + (2*pd1_d*(2*pd3*p1^3 - 2*pd3*p1^2*p2*p3 + 2*pd2*p1^2*p3^2 + 2*pd2*p1^2 - 2*pd3*p1*p2^2 + 2*pd3*p1*p3^2 + 2*pd3*p1 + 2*pd3*p2^3*p3 - 2*pd2*p2^2*p3^2 - 2*pd2*p2^2 - 2*pd3*p2*p3^3 - 2*pd3*p2*p3 + 2*pd2*p3^4 + 4*pd2*p3^2 + 2*pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd3_d*((2*((pd2 + p1*pd3 + p3*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + pd2_d*(- (2*p1*((pd2 + p1*pd3 + p3*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2 - pd3 + p2*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd3_d*(- p1^2*p2 + p2^3 - p2*p3^2 + p2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(2*pd1*p1^3 + 2*pd3*p1^2*p3 + 2*pd1*p1*p2^2 + 2*pd1*p1*p3^2 + 2*pd1*p1 + 2*pd3*p2^2*p3 + 2*pd3*p3^3 + 2*pd3*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (pd2_d*(- (2*p1*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + pd3_d*((2*(- (p3*(pd2 + p1*pd3 + p3*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (p3*(p1*pd2 - pd3 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(- pd3*p1^4 + 2*pd1*p1^3*p3 - 2*pd3*p1^2 + 2*pd1*p1*p2^2*p3 + 2*pd1*p1*p3^3 + 2*pd1*p1*p3 + pd3*p2^4 + 2*pd3*p2^2*p3^2 + pd3*p3^4 - pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, (-qddy_d), qddx_d, 0, ((4*pd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (2*pd1_d*(2*pd3*p1^3 - 2*pd1*p1^2*p3 + 2*pd2*p1^2 - 2*pd3*p1*p2^2 + 4*pd2*p1*p2*p3 + 2*pd3*p1*p3^2 + 2*pd3*p1 - 2*pd1*p2^2*p3 - 2*pd2*p2^2 - 4*pd3*p2*p3 - 2*pd1*p3^3 + 2*pd2*p3^2 - 2*pd1*p3 + 2*pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) - (4*p2*pd3_d*(p1^2 - p2^2 + p3^2 - 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2), (pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 + (4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*p1*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2) + (2*pd1_d*(- 2*pd2*p1^3*p2 - 2*pd3*p1^3*p3 + 2*pd1*p1^2*p2^2 + 2*pd3*p1^2*p2 + 2*pd1*p1^2*p3^2 - 2*pd2*p1^2*p3 - 2*pd2*p1*p2^3 + 2*pd3*p1*p2^2*p3 - 6*pd2*p1*p2*p3^2 - 2*pd2*p1*p2 - 2*pd3*p1*p3^3 - 2*pd3*p1*p3 + 2*pd1*p2^4 + 2*pd3*p2^3 + 4*pd1*p2^2*p3^2 + 2*pd2*p2^2*p3 + 2*pd1*p2^2 + 6*pd3*p2*p3^2 + 2*pd3*p2 + 2*pd1*p3^4 - 2*pd2*p3^3 + 2*pd1*p3^2 - 2*pd2*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), 0, (pd2_d*((4*p1*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 - (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - pd3_d*((4*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1)^2 - (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - (2*pd1_d*(- 2*pd2*p1^3*p2 + 2*pd1*p1^2*p2^2 + 2*pd2*p1^2*p3 + 2*pd1*p1^2 - 2*pd2*p1*p2^3 - 2*pd2*p1*p2*p3^2 - 6*pd2*p1*p2 + 2*pd1*p2^4 + 4*pd3*p2^3 + 2*pd1*p2^2*p3^2 - 2*pd2*p2^2*p3 + 4*pd1*p2^2 + 4*pd3*p2 + 2*pd2*p3^3 + 2*pd1*p3^2 + 2*pd2*p3 + 2*pd1))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- (4*pd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (2*pd1_d*(- 2*pd3*p1^2*p2*p3 + 2*pd2*p1^2*p3^2 + 2*pd1*p1^2*p3 - 4*pd2*p1*p2*p3 + 2*pd3*p2^3*p3 - 2*pd2*p2^2*p3^2 + 2*pd1*p2^2*p3 - 2*pd3*p2*p3^3 + 2*pd3*p2*p3 + 2*pd2*p3^4 + 2*pd1*p3^3 + 2*pd2*p3^2 + 2*pd1*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) - (4*pd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2), 0, ((2*pd1_d*(2*pd3*p1^3*p2 - 2*pd1*p1^2*p2*p3 + 2*pd2*p1^2*p2 - 2*pd3*p1*p2^3 + 4*pd2*p1*p2^2*p3 + 2*pd3*p1*p2*p3^2 + 2*pd3*p1*p2 - 2*pd1*p2^3*p3 - 2*pd2*p2^3 - 4*pd3*p2^2*p3 - 2*pd1*p2*p3^3 + 2*pd2*p2*p3^2 - 2*pd1*p2*p3 + 2*pd2*p2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) + (4*pd3_d*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (4*p1*pd2_d*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), (- (2*pd1_d*(- 2*pd3*p1^2*p2^2 + 2*pd2*p1^2*p2*p3 + 2*pd1*p1^2*p2 - 4*pd2*p1*p2^2 + 2*pd3*p2^4 - 2*pd2*p2^3*p3 + 2*pd1*p2^3 - 2*pd3*p2^2*p3^2 + 2*pd3*p2^2 + 2*pd2*p2*p3^3 + 2*pd1*p2*p3^2 + 2*pd2*p2*p3 + 2*pd1*p2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) - (4*pd3_d*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (4*p1*pd2_d*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/((p1^2 - p2^2 + p3^2 + 1)*(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))), 0, (- (4*pd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (2*pd1_d*(- 2*pd3*p1^2*p2*p3 + 2*pd2*p1^2*p3^2 + 2*pd1*p1^2*p3 - 4*pd2*p1*p2*p3 + 2*pd3*p2^3*p3 - 2*pd2*p2^2*p3^2 + 2*pd1*p2^2*p3 - 2*pd3*p2*p3^3 + 2*pd3*p2*p3 + 2*pd2*p3^4 + 2*pd1*p3^3 + 2*pd2*p3^2 + 2*pd1*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) - (4*pd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2), (- pd3_d*((4*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (4*p2*(p1^2 - p2^2 + p3^2 - 1)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) - pd2_d*((4*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 - (4*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(- pd3*p1^2*p2 + pd2*p1^2*p3 + pd1*p1^2 - 2*pd2*p1*p2 + pd3*p2^3 - pd2*p2^2*p3 + pd1*p2^2 - pd3*p2*p3^2 + pd3*p2 + pd2*p3^3 + pd1*p3^2 + pd2*p3 + pd1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2) + (2*pd1_d*(2*pd3*p1^3*p3 - 2*pd3*p1^2*p2 - 2*pd1*p1^2*p3^2 + 4*pd2*p1^2*p3 + 2*pd1*p1^2 - 2*pd3*p1*p2^2*p3 + 4*pd2*p1*p2*p3^2 - 4*pd2*p1*p2 + 2*pd3*p1*p3^3 + 2*pd3*p1*p3 + 2*pd3*p2^3 - 2*pd1*p2^2*p3^2 - 4*pd2*p2^2*p3 + 2*pd1*p2^2 - 6*pd3*p2*p3^2 + 2*pd3*p2 - 2*pd1*p3^4 + 4*pd2*p3^3 + 4*pd2*p3 + 2*pd1))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- pd3_d*((2*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - pd2_d*(- (2*p1*((2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*p3*pd3*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pd2*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*((2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*pd1)/(p1^2 - p2^2 + p3^2 + 1) - (2*p2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*pdd3_d*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*pd1_d*(2*pd2*p1^3*p3 + 2*pd1*p1^3 - 2*pd1*p1^2*p2*p3 + 2*pd2*p1*p2^2*p3 + 2*pd1*p1*p2^2 + 2*pd2*p1*p3^3 + 2*pd1*p1*p3^2 + 2*pd2*p1*p3 + 2*pd1*p1 - 2*pd1*p2^3*p3 - 2*pd1*p2*p3^3 - 2*pd1*p2*p3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), ((4*pd2_d*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2 + (2*pd1_d*(2*pd3*p1^3 - 2*pd1*p1^2*p3 + 2*pd2*p1^2 - 2*pd3*p1*p2^2 + 4*pd2*p1*p2*p3 + 2*pd3*p1*p3^2 + 2*pd3*p1 - 2*pd1*p2^2*p3 - 2*pd2*p2^2 - 4*pd3*p2*p3 - 2*pd1*p3^3 + 2*pd2*p3^2 - 2*pd1*p3 + 2*pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)) - (4*p2*pd3_d*(p1^2 - p2^2 + p3^2 - 1)*(pd3*p1^3 - pd1*p1^2*p3 + pd2*p1^2 - pd3*p1*p2^2 + 2*pd2*p1*p2*p3 + pd3*p1*p3^2 + pd3*p1 - pd1*p2^2*p3 - pd2*p2^2 - 2*pd3*p2*p3 - pd1*p3^3 + pd2*p3^2 - pd1*p3 + pd2))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)^2), (- pd3_d*((2*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*(p1^2 - p2^2 + p3^2 - 1)*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) - (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + pd2_d*((2*((2*(pd3 - p1*pd2 + p2*pd1))/(p1^2 - p2^2 + p3^2 + 1) - (2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*p3*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*(- (2*p3*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2)*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p2*pd2*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p1*(- (2*p3*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2)*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*p3*pd3*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1)) + (2*pdd2_d*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p3*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*pdd3_d*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) + (2*pd1_d*(- pd3*p1^4 + 2*pd1*p1^3*p3 - 2*pd2*p1^3 + 2*pd1*p1^2*p2 + 2*pd1*p1*p2^2*p3 - 2*pd2*p1*p2^2 + 2*pd1*p1*p3^3 - 2*pd2*p1*p3^2 + 2*pd1*p1*p3 - 2*pd2*p1 + pd3*p2^4 + 2*pd1*p2^3 + 2*pd3*p2^2*p3^2 + 2*pd3*p2^2 + 2*pd1*p2*p3^2 + 2*pd1*p2 + pd3*p3^4 + 2*pd3*p3^2 + pd3))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1))), (- pd3_d*((2*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^3 - p1*p2^2 + p1*p3^2 + p1 - 2*p2*p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 - p2^2 + p3^2 - 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) + (2*pdd3_d)/(p1^2 - p2^2 + p3^2 + 1) - pd2_d*((2*((2*(pd1/2 + (p2*pd3)/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*((p1*pd2)/2 - pd3/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*p2*pd2)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2 + 2*p1*p2*p3 - p2^2 + p3^2 + 1))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1) - (2*p1*(- (2*p1*((p2*pd3)/2 - pd1/2 + (p3*pd2)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*(pd2/2 + (p1*pd3)/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p3*pd3)/(p1^2 - p2^2 + p3^2 + 1)))/(p1^2 - p2^2 + p3^2 + 1) + (2*((2*((p1*pd3)/2 - pd2/2 + (p3*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) - (2*p1*(pd3/2 + (p1*pd2)/2 + (p2*pd1)/2))/(p1^2 - p2^2 + p3^2 + 1) + (2*p1*p2*pd1)/(p1^2 - p2^2 + p3^2 + 1))*(p1^2*p3 - 2*p1*p2 - p2^2*p3 + p3^3 + p3))/(p1^4 + 2*p1^2*p3^2 + 2*p1^2 - p2^4 + p3^4 + 2*p3^2 + 1)) - (2*p1*pdd2_d)/(p1^2 - p2^2 + p3^2 + 1) + (2*p2*pdd1_d)/(p1^2 - p2^2 + p3^2 + 1) - (2*pd1_d*(- pd2*p1^4 + 2*pd1*p1^3*p2 + 2*pd3*p1^2*p2*p3 - 2*pd2*p1^2*p3^2 - 2*pd2*p1^2 + 2*pd1*p1*p2^3 + 2*pd1*p1*p2*p3^2 + 2*pd1*p1*p2 + pd2*p2^4 + 2*pd3*p2^3*p3 + 2*pd3*p2*p3^3 + 2*pd3*p2*p3 - pd2*p3^4 - 2*pd2*p3^2 - pd2))/((p1^2 - p2^2 + p3^2 + 1)^2*(p1^2 + p2^2 + p3^2 + 1)))];
};